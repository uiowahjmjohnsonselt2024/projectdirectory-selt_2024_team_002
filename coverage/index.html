<!DOCTYPE html>
<html xmlns='http://www.w3.org/1999/xhtml'>
  <head>
    <title>Code coverage for Projectdirectory-selt 2024 team 002</title>
    <meta http-equiv="content-type" content="text/html; charset=utf-8" />
    <script src='./assets/0.13.1/application.js' type='text/javascript'></script>
    <link href='./assets/0.13.1/application.css' media='screen, projection, print' rel='stylesheet' type='text/css' />
    <link rel="icon" type="image/png" href="./assets/0.13.1/favicon_yellow.png" />
  </head>

  <body>
    <div id="loading">
      <img src="./assets/0.13.1/loading.gif" alt="loading"/>
    </div>
    <div id="wrapper" class="hide">
<<<<<<< HEAD
      <div class="timestamp">Generated <abbr class="timeago" title="2024-12-08T01:37:37-06:00">2024-12-08T01:37:37-06:00</abbr></div>
=======
      <div class="timestamp">Generated <abbr class="timeago" title="2024-12-07T14:52:24-06:00">2024-12-07T14:52:24-06:00</abbr></div>
>>>>>>> da2c136166f7c28bb78c4064cea4e4d3464ce5e3
      <ul class="group_tabs"></ul>

      <div id="content">
        <div class="file_list_container" id="AllFiles">
  <h2>
    <span class="group_name">All Files</span>
    (<span class="covered_percent">
      <span class="yellow">
<<<<<<< HEAD
  85.09%
=======
  85.35%
>>>>>>> da2c136166f7c28bb78c4064cea4e4d3464ce5e3
</span>

     </span>
     covered at
     <span class="covered_strength">
       <span class="green">
<<<<<<< HEAD
         1.6
=======
         1.66
>>>>>>> da2c136166f7c28bb78c4064cea4e4d3464ce5e3
       </span>
    </span> hits/line
    )
  </h2>

  <a name="AllFiles"></a>

  <div>
    <b>8</b> files in total.
  </div>

  <div class="t-line-summary">
<<<<<<< HEAD
    <b>389</b> relevant lines,
    <span class="green"><b>331</b> lines covered</span> and
    <span class="red"><b>58</b> lines missed. </span>
    (<span class="yellow">
  85.09%
=======
    <b>355</b> relevant lines,
    <span class="green"><b>303</b> lines covered</span> and
    <span class="red"><b>52</b> lines missed. </span>
    (<span class="yellow">
  85.35%
>>>>>>> da2c136166f7c28bb78c4064cea4e4d3464ce5e3
</span>
)
  </div>

  

  <div class="file_list--responsive">
    <table class="file_list">
      <thead>
        <tr>
          <th>File</th>
          <th class="cell--number">% covered</th>
          <th class="cell--number">Lines</th>
          <th class="cell--number">Relevant Lines</th>
          <th class="cell--number">Lines covered</th>
          <th class="cell--number">Lines missed</th>
          <th class="cell--number">Avg. Hits / Line</th>
          
        </tr>
      </thead>
      <tbody>
        
          <tr class="t-file">
<<<<<<< HEAD
            <td class="strong t-file__name"><a href="#039e9ff2571fd28bb52cbe529de116a5f56b25e2" class="src_link" title="app/controllers/users_controller.rb">app/controllers/users_controller.rb</a></td>
            <td class="yellow strong cell--number t-file__coverage">81.12 %</td>
            <td class="cell--number">307</td>
            <td class="cell--number">196</td>
            <td class="cell--number">159</td>
            <td class="cell--number">37</td>
            <td class="cell--number">1.56</td>
            
          </tr>
        
          <tr class="t-file">
            <td class="strong t-file__name"><a href="#1b4728b25b121f825e3cbd762599532a0e3f5013" class="src_link" title="app/controllers/users_worlds_controller.rb">app/controllers/users_worlds_controller.rb</a></td>
            <td class="green strong cell--number t-file__coverage">92.00 %</td>
            <td class="cell--number">53</td>
            <td class="cell--number">25</td>
            <td class="cell--number">23</td>
            <td class="cell--number">2</td>
            <td class="cell--number">1.08</td>
=======
            <td class="strong t-file__name"><a href="#f3e172f56b6457ee96a4dbbe6ec1f14ead5fe3d3" class="src_link" title="app/controllers/users_controller.rb">app/controllers/users_controller.rb</a></td>
            <td class="yellow strong cell--number t-file__coverage">82.29 %</td>
            <td class="cell--number">300</td>
            <td class="cell--number">192</td>
            <td class="cell--number">158</td>
            <td class="cell--number">34</td>
            <td class="cell--number">1.58</td>
>>>>>>> da2c136166f7c28bb78c4064cea4e4d3464ce5e3
            
          </tr>
        
          <tr class="t-file">
            <td class="strong t-file__name"><a href="#2cc59cbd4ca9886ff1431a2b08cee804fd811074" class="src_link" title="app/controllers/worlds_controller.rb">app/controllers/worlds_controller.rb</a></td>
            <td class="green strong cell--number t-file__coverage">96.92 %</td>
            <td class="cell--number">112</td>
            <td class="cell--number">65</td>
            <td class="cell--number">63</td>
            <td class="cell--number">2</td>
            <td class="cell--number">1.62</td>
            
          </tr>
        
          <tr class="t-file">
            <td class="strong t-file__name"><a href="#2667f2133f338aa49d38eb8e461ca77e3b64762d" class="src_link" title="app/models/friendship.rb">app/models/friendship.rb</a></td>
            <td class="yellow strong cell--number t-file__coverage">86.67 %</td>
            <td class="cell--number">40</td>
            <td class="cell--number">15</td>
            <td class="cell--number">13</td>
            <td class="cell--number">2</td>
            <td class="cell--number">0.87</td>
            
          </tr>
        
          <tr class="t-file">
            <td class="strong t-file__name"><a href="#841cffe5ec2171dffd913f8f79082bf72d86bcac" class="src_link" title="app/models/gridsquare.rb">app/models/gridsquare.rb</a></td>
            <td class="red strong cell--number t-file__coverage">0.00 %</td>
            <td class="cell--number">9</td>
            <td class="cell--number">6</td>
            <td class="cell--number">0</td>
            <td class="cell--number">6</td>
            <td class="cell--number">0.00</td>
            
          </tr>
        
          <tr class="t-file">
<<<<<<< HEAD
            <td class="strong t-file__name"><a href="#f6b58ed9e9645b33485a566bee0b69f1e3e60c5a" class="src_link" title="app/models/user.rb">app/models/user.rb</a></td>
=======
            <td class="strong t-file__name"><a href="#63f1edfd6ae6a2adfb77c3e9841b93453c5dd110" class="src_link" title="app/models/user.rb">app/models/user.rb</a></td>
>>>>>>> da2c136166f7c28bb78c4064cea4e4d3464ce5e3
            <td class="yellow strong cell--number t-file__coverage">84.00 %</td>
            <td class="cell--number">89</td>
            <td class="cell--number">50</td>
            <td class="cell--number">42</td>
            <td class="cell--number">8</td>
            <td class="cell--number">1.96</td>
            
          </tr>
        
          <tr class="t-file">
            <td class="strong t-file__name"><a href="#a1f6b1f417257d7d7e4221a3f0fcb8e2e202fc30" class="src_link" title="app/models/user_world.rb">app/models/user_world.rb</a></td>
            <td class="yellow strong cell--number t-file__coverage">83.33 %</td>
            <td class="cell--number">13</td>
            <td class="cell--number">6</td>
            <td class="cell--number">5</td>
            <td class="cell--number">1</td>
            <td class="cell--number">0.83</td>
            
          </tr>
        
          <tr class="t-file">
            <td class="strong t-file__name"><a href="#783ef1938c362b87740078c5fd9de7ccf1e498ed" class="src_link" title="app/models/world.rb">app/models/world.rb</a></td>
            <td class="green strong cell--number t-file__coverage">100.00 %</td>
            <td class="cell--number">51</td>
            <td class="cell--number">26</td>
            <td class="cell--number">26</td>
            <td class="cell--number">0</td>
            <td class="cell--number">2.65</td>
            
          </tr>
        
      </tbody>
    </table>
  </div>
</div>


        
          <div class="file_list_container" id="Controllers">
  <h2>
    <span class="group_name">Controllers</span>
    (<span class="covered_percent">
      <span class="yellow">
<<<<<<< HEAD
  85.66%
=======
  85.83%
>>>>>>> da2c136166f7c28bb78c4064cea4e4d3464ce5e3
</span>

     </span>
     covered at
     <span class="covered_strength">
       <span class="green">
         1.53
       </span>
    </span> hits/line
    )
  </h2>

  <a name="Controllers"></a>

  <div>
    <b>3</b> files in total.
  </div>

  <div class="t-line-summary">
<<<<<<< HEAD
    <b>286</b> relevant lines,
    <span class="green"><b>245</b> lines covered</span> and
    <span class="red"><b>41</b> lines missed. </span>
    (<span class="yellow">
  85.66%
=======
    <b>254</b> relevant lines,
    <span class="green"><b>218</b> lines covered</span> and
    <span class="red"><b>36</b> lines missed. </span>
    (<span class="yellow">
  85.83%
>>>>>>> da2c136166f7c28bb78c4064cea4e4d3464ce5e3
</span>
)
  </div>

  

  <div class="file_list--responsive">
    <table class="file_list">
      <thead>
        <tr>
          <th>File</th>
          <th class="cell--number">% covered</th>
          <th class="cell--number">Lines</th>
          <th class="cell--number">Relevant Lines</th>
          <th class="cell--number">Lines covered</th>
          <th class="cell--number">Lines missed</th>
          <th class="cell--number">Avg. Hits / Line</th>
          
        </tr>
      </thead>
      <tbody>
        
          <tr class="t-file">
<<<<<<< HEAD
            <td class="strong t-file__name"><a href="#039e9ff2571fd28bb52cbe529de116a5f56b25e2" class="src_link" title="app/controllers/users_controller.rb">app/controllers/users_controller.rb</a></td>
            <td class="yellow strong cell--number t-file__coverage">81.12 %</td>
            <td class="cell--number">307</td>
            <td class="cell--number">196</td>
            <td class="cell--number">159</td>
            <td class="cell--number">37</td>
            <td class="cell--number">1.56</td>
            
          </tr>
        
          <tr class="t-file">
            <td class="strong t-file__name"><a href="#1b4728b25b121f825e3cbd762599532a0e3f5013" class="src_link" title="app/controllers/users_worlds_controller.rb">app/controllers/users_worlds_controller.rb</a></td>
            <td class="green strong cell--number t-file__coverage">92.00 %</td>
            <td class="cell--number">53</td>
            <td class="cell--number">25</td>
            <td class="cell--number">23</td>
            <td class="cell--number">2</td>
            <td class="cell--number">1.08</td>
=======
            <td class="strong t-file__name"><a href="#f3e172f56b6457ee96a4dbbe6ec1f14ead5fe3d3" class="src_link" title="app/controllers/users_controller.rb">app/controllers/users_controller.rb</a></td>
            <td class="yellow strong cell--number t-file__coverage">82.29 %</td>
            <td class="cell--number">300</td>
            <td class="cell--number">192</td>
            <td class="cell--number">158</td>
            <td class="cell--number">34</td>
            <td class="cell--number">1.58</td>
>>>>>>> da2c136166f7c28bb78c4064cea4e4d3464ce5e3
            
          </tr>
        
          <tr class="t-file">
            <td class="strong t-file__name"><a href="#2cc59cbd4ca9886ff1431a2b08cee804fd811074" class="src_link" title="app/controllers/worlds_controller.rb">app/controllers/worlds_controller.rb</a></td>
            <td class="green strong cell--number t-file__coverage">96.92 %</td>
            <td class="cell--number">112</td>
            <td class="cell--number">65</td>
            <td class="cell--number">63</td>
            <td class="cell--number">2</td>
            <td class="cell--number">1.62</td>
            
          </tr>
        
      </tbody>
    </table>
  </div>
</div>

        
          <div class="file_list_container" id="Channels">
  <h2>
    <span class="group_name">Channels</span>
    (<span class="covered_percent">
      <span class="green">
  100.0%
</span>

     </span>
     covered at
     <span class="covered_strength">
       <span class="red">
         0.0
       </span>
    </span> hits/line
    )
  </h2>

  <a name="Channels"></a>

  <div>
    <b>0</b> files in total.
  </div>

  <div class="t-line-summary">
    <b>0</b> relevant lines,
    <span class="green"><b>0</b> lines covered</span> and
    <span class="red"><b>0</b> lines missed. </span>
    (<span class="green">
  100.0%
</span>
)
  </div>

  

  <div class="file_list--responsive">
    <table class="file_list">
      <thead>
        <tr>
          <th>File</th>
          <th class="cell--number">% covered</th>
          <th class="cell--number">Lines</th>
          <th class="cell--number">Relevant Lines</th>
          <th class="cell--number">Lines covered</th>
          <th class="cell--number">Lines missed</th>
          <th class="cell--number">Avg. Hits / Line</th>
          
        </tr>
      </thead>
      <tbody>
        
      </tbody>
    </table>
  </div>
</div>

        
          <div class="file_list_container" id="Models">
  <h2>
    <span class="group_name">Models</span>
    (<span class="covered_percent">
      <span class="yellow">
<<<<<<< HEAD
  83.5%
=======
  84.16%
>>>>>>> da2c136166f7c28bb78c4064cea4e4d3464ce5e3
</span>

     </span>
     covered at
     <span class="covered_strength">
       <span class="green">
<<<<<<< HEAD
         1.8
=======
         1.82
>>>>>>> da2c136166f7c28bb78c4064cea4e4d3464ce5e3
       </span>
    </span> hits/line
    )
  </h2>

  <a name="Models"></a>

  <div>
    <b>5</b> files in total.
  </div>

  <div class="t-line-summary">
<<<<<<< HEAD
    <b>103</b> relevant lines,
    <span class="green"><b>86</b> lines covered</span> and
    <span class="red"><b>17</b> lines missed. </span>
    (<span class="yellow">
  83.5%
=======
    <b>101</b> relevant lines,
    <span class="green"><b>85</b> lines covered</span> and
    <span class="red"><b>16</b> lines missed. </span>
    (<span class="yellow">
  84.16%
>>>>>>> da2c136166f7c28bb78c4064cea4e4d3464ce5e3
</span>
)
  </div>

  

  <div class="file_list--responsive">
    <table class="file_list">
      <thead>
        <tr>
          <th>File</th>
          <th class="cell--number">% covered</th>
          <th class="cell--number">Lines</th>
          <th class="cell--number">Relevant Lines</th>
          <th class="cell--number">Lines covered</th>
          <th class="cell--number">Lines missed</th>
          <th class="cell--number">Avg. Hits / Line</th>
          
        </tr>
      </thead>
      <tbody>
        
          <tr class="t-file">
            <td class="strong t-file__name"><a href="#2667f2133f338aa49d38eb8e461ca77e3b64762d" class="src_link" title="app/models/friendship.rb">app/models/friendship.rb</a></td>
            <td class="yellow strong cell--number t-file__coverage">86.67 %</td>
            <td class="cell--number">40</td>
            <td class="cell--number">15</td>
            <td class="cell--number">13</td>
            <td class="cell--number">2</td>
            <td class="cell--number">0.87</td>
            
          </tr>
        
          <tr class="t-file">
            <td class="strong t-file__name"><a href="#841cffe5ec2171dffd913f8f79082bf72d86bcac" class="src_link" title="app/models/gridsquare.rb">app/models/gridsquare.rb</a></td>
            <td class="red strong cell--number t-file__coverage">0.00 %</td>
            <td class="cell--number">9</td>
            <td class="cell--number">6</td>
            <td class="cell--number">0</td>
            <td class="cell--number">6</td>
            <td class="cell--number">0.00</td>
            
          </tr>
        
          <tr class="t-file">
<<<<<<< HEAD
            <td class="strong t-file__name"><a href="#f6b58ed9e9645b33485a566bee0b69f1e3e60c5a" class="src_link" title="app/models/user.rb">app/models/user.rb</a></td>
=======
            <td class="strong t-file__name"><a href="#63f1edfd6ae6a2adfb77c3e9841b93453c5dd110" class="src_link" title="app/models/user.rb">app/models/user.rb</a></td>
>>>>>>> da2c136166f7c28bb78c4064cea4e4d3464ce5e3
            <td class="yellow strong cell--number t-file__coverage">84.00 %</td>
            <td class="cell--number">89</td>
            <td class="cell--number">50</td>
            <td class="cell--number">42</td>
            <td class="cell--number">8</td>
            <td class="cell--number">1.96</td>
            
          </tr>
        
          <tr class="t-file">
            <td class="strong t-file__name"><a href="#a1f6b1f417257d7d7e4221a3f0fcb8e2e202fc30" class="src_link" title="app/models/user_world.rb">app/models/user_world.rb</a></td>
            <td class="yellow strong cell--number t-file__coverage">83.33 %</td>
            <td class="cell--number">13</td>
            <td class="cell--number">6</td>
            <td class="cell--number">5</td>
            <td class="cell--number">1</td>
            <td class="cell--number">0.83</td>
            
          </tr>
        
          <tr class="t-file">
            <td class="strong t-file__name"><a href="#783ef1938c362b87740078c5fd9de7ccf1e498ed" class="src_link" title="app/models/world.rb">app/models/world.rb</a></td>
            <td class="green strong cell--number t-file__coverage">100.00 %</td>
            <td class="cell--number">51</td>
            <td class="cell--number">26</td>
            <td class="cell--number">26</td>
            <td class="cell--number">0</td>
            <td class="cell--number">2.65</td>
            
          </tr>
        
      </tbody>
    </table>
  </div>
</div>

        
          <div class="file_list_container" id="Mailers">
  <h2>
    <span class="group_name">Mailers</span>
    (<span class="covered_percent">
      <span class="green">
  100.0%
</span>

     </span>
     covered at
     <span class="covered_strength">
       <span class="red">
         0.0
       </span>
    </span> hits/line
    )
  </h2>

  <a name="Mailers"></a>

  <div>
    <b>0</b> files in total.
  </div>

  <div class="t-line-summary">
    <b>0</b> relevant lines,
    <span class="green"><b>0</b> lines covered</span> and
    <span class="red"><b>0</b> lines missed. </span>
    (<span class="green">
  100.0%
</span>
)
  </div>

  

  <div class="file_list--responsive">
    <table class="file_list">
      <thead>
        <tr>
          <th>File</th>
          <th class="cell--number">% covered</th>
          <th class="cell--number">Lines</th>
          <th class="cell--number">Relevant Lines</th>
          <th class="cell--number">Lines covered</th>
          <th class="cell--number">Lines missed</th>
          <th class="cell--number">Avg. Hits / Line</th>
          
        </tr>
      </thead>
      <tbody>
        
      </tbody>
    </table>
  </div>
</div>

        
          <div class="file_list_container" id="Helpers">
  <h2>
    <span class="group_name">Helpers</span>
    (<span class="covered_percent">
      <span class="green">
  100.0%
</span>

     </span>
     covered at
     <span class="covered_strength">
       <span class="red">
         0.0
       </span>
    </span> hits/line
    )
  </h2>

  <a name="Helpers"></a>

  <div>
    <b>0</b> files in total.
  </div>

  <div class="t-line-summary">
    <b>0</b> relevant lines,
    <span class="green"><b>0</b> lines covered</span> and
    <span class="red"><b>0</b> lines missed. </span>
    (<span class="green">
  100.0%
</span>
)
  </div>

  

  <div class="file_list--responsive">
    <table class="file_list">
      <thead>
        <tr>
          <th>File</th>
          <th class="cell--number">% covered</th>
          <th class="cell--number">Lines</th>
          <th class="cell--number">Relevant Lines</th>
          <th class="cell--number">Lines covered</th>
          <th class="cell--number">Lines missed</th>
          <th class="cell--number">Avg. Hits / Line</th>
          
        </tr>
      </thead>
      <tbody>
        
      </tbody>
    </table>
  </div>
</div>

        
          <div class="file_list_container" id="Jobs">
  <h2>
    <span class="group_name">Jobs</span>
    (<span class="covered_percent">
      <span class="green">
  100.0%
</span>

     </span>
     covered at
     <span class="covered_strength">
       <span class="red">
         0.0
       </span>
    </span> hits/line
    )
  </h2>

  <a name="Jobs"></a>

  <div>
    <b>0</b> files in total.
  </div>

  <div class="t-line-summary">
    <b>0</b> relevant lines,
    <span class="green"><b>0</b> lines covered</span> and
    <span class="red"><b>0</b> lines missed. </span>
    (<span class="green">
  100.0%
</span>
)
  </div>

  

  <div class="file_list--responsive">
    <table class="file_list">
      <thead>
        <tr>
          <th>File</th>
          <th class="cell--number">% covered</th>
          <th class="cell--number">Lines</th>
          <th class="cell--number">Relevant Lines</th>
          <th class="cell--number">Lines covered</th>
          <th class="cell--number">Lines missed</th>
          <th class="cell--number">Avg. Hits / Line</th>
          
        </tr>
      </thead>
      <tbody>
        
      </tbody>
    </table>
  </div>
</div>

        
          <div class="file_list_container" id="Libraries">
  <h2>
    <span class="group_name">Libraries</span>
    (<span class="covered_percent">
      <span class="green">
  100.0%
</span>

     </span>
     covered at
     <span class="covered_strength">
       <span class="red">
         0.0
       </span>
    </span> hits/line
    )
  </h2>

  <a name="Libraries"></a>

  <div>
    <b>0</b> files in total.
  </div>

  <div class="t-line-summary">
    <b>0</b> relevant lines,
    <span class="green"><b>0</b> lines covered</span> and
    <span class="red"><b>0</b> lines missed. </span>
    (<span class="green">
  100.0%
</span>
)
  </div>

  

  <div class="file_list--responsive">
    <table class="file_list">
      <thead>
        <tr>
          <th>File</th>
          <th class="cell--number">% covered</th>
          <th class="cell--number">Lines</th>
          <th class="cell--number">Relevant Lines</th>
          <th class="cell--number">Lines covered</th>
          <th class="cell--number">Lines missed</th>
          <th class="cell--number">Avg. Hits / Line</th>
          
        </tr>
      </thead>
      <tbody>
        
      </tbody>
    </table>
  </div>
</div>

        
      </div>

      <div id="footer">
        Generated by <a href="https://github.com/simplecov-ruby/simplecov">simplecov</a> v0.22.0
        and simplecov-html v0.13.1<br/>
        using RSpec
      </div>

      <div class="source_files">
      
        <div class="source_table" id="039e9ff2571fd28bb52cbe529de116a5f56b25e2">
  <div class="header">
    <h3>app/controllers/users_controller.rb</h3>
    <h4>
      <span class="yellow">
<<<<<<< HEAD
  81.12%
=======
  82.29%
>>>>>>> da2c136166f7c28bb78c4064cea4e4d3464ce5e3
</span>

      lines covered
    </h4>

    

    <div class="t-line-summary">
<<<<<<< HEAD
      <b>196</b> relevant lines.
      <span class="green"><b>159</b> lines covered</span> and
      <span class="red"><b>37</b> lines missed.</span>
=======
      <b>192</b> relevant lines.
      <span class="green"><b>158</b> lines covered</span> and
      <span class="red"><b>34</b> lines missed.</span>
>>>>>>> da2c136166f7c28bb78c4064cea4e4d3464ce5e3
    </div>

    

  </div>

  <pre>
    <ol>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1">
            

            

            <code class="ruby"># frozen_string_literal: true</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="2">
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="3">
            

            

            <code class="ruby"># Controller for handling user-related actions.</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="4">
            

            

            <code class="ruby"># rubocop:disable all</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="5">
            
              <span class="hits">1</span>
            

            

            <code class="ruby">class UsersController &lt; ApplicationController</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="6">
            
              <span class="hits">1</span>
            

            

            <code class="ruby">  require &#39;credit_card_detector&#39;</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="7">
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="8">
            
              <span class="hits">1</span>
            

            

            <code class="ruby">  def new</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="9">
            

            

            <code class="ruby">    # render default template</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="10">
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="11">
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="12">
            

            

            <code class="ruby">  # rubo cop complains that it&#39;s too long. But password confirmation checking should not be in the model</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="13">
            
              <span class="hits">1</span>
            

            

            <code class="ruby">  def create</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="4" data-linenumber="14">
            
              <span class="hits">4</span>
            

            

            <code class="ruby">    form = params[:user]</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="4" data-linenumber="15">
            
              <span class="hits">4</span>
            

            

            <code class="ruby">    if form[:password_confirmation] != form[:password]</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="2" data-linenumber="16">
            
              <span class="hits">2</span>
            

            

            <code class="ruby">      flash[:alert] = &#39;Password confirmation must match&#39;</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="2" data-linenumber="17">
            
              <span class="hits">2</span>
            

            

            <code class="ruby">      return redirect_to new_user_path</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="18">
            

            

            <code class="ruby">    end</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="2" data-linenumber="19">
            
              <span class="hits">2</span>
            

            

            <code class="ruby">    usr = User.new(email: form[:email], display_name: form[:user_name], password: form[:password])</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="2" data-linenumber="20">
            
              <span class="hits">2</span>
            

            

            <code class="ruby">    if usr.valid? &amp;&amp; usr.save</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="21">
            
              <span class="hits">1</span>
            

            

            <code class="ruby">      flash[:notice] = &#39;Account created successfully&#39;</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="22">
            
              <span class="hits">1</span>
            

            

            <code class="ruby">      return redirect_to users_login_path</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="23">
            

            

            <code class="ruby">    end</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="24">
            
              <span class="hits">1</span>
            

            

            <code class="ruby">    flash[:alert] = usr.errors.empty? ? &#39;Something went wrong&#39; : usr.errors.full_messages.first</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="25">
            
              <span class="hits">1</span>
            

            

            <code class="ruby">    redirect_to new_user_path</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="26">
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="27">
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="28">
            
              <span class="hits">1</span>
            

            

            <code class="ruby">  def show; end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="29">
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="30">
            
              <span class="hits">1</span>
            

            

            <code class="ruby">  def edit; end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="31">
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="32">
            
              <span class="hits">1</span>
            

            

            <code class="ruby">  def update; end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="33">
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="34">
            
              <span class="hits">1</span>
            

            

            <code class="ruby">  def login</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="2" data-linenumber="35">
            
              <span class="hits">2</span>
            

            

            <code class="ruby">    cur_user = User.find_user_by_session_token(cookies[:session])</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="2" data-linenumber="36">
            
              <span class="hits">2</span>
            

            

            <code class="ruby">    if cur_user != nil </code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="37">
            
              <span class="hits">1</span>
            

            

            <code class="ruby">      redirect_to worlds_path</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="38">
            

            

            <code class="ruby">    end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="39">
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="40">
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="41">
            
              <span class="hits">1</span>
            

            

            <code class="ruby">  def forgot_password</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="42">
            

            

            <code class="ruby">    # renders the forgot password page</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="43">
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="44">
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="45">
            
              <span class="hits">1</span>
            

            

            <code class="ruby">  def send_reset_email</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="46">
            

            

            <code class="ruby">    # send email to user</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="47">
            
              <span class="hits">1</span>
            

            

            <code class="ruby">    user = User.find_by_email(params[:email])</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="48">
            
              <span class="hits">1</span>
            

            

            <code class="ruby">    if user</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="49">
            

            

            <code class="ruby">      user.generate_reset_password_token</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="50">
            

            

            <code class="ruby">      UserMailer.send_reset_password_email(user).deliver_now</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="51">
            

            

            <code class="ruby">      flash[:notice] = &#39;Password reset email sent!&#39;</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="52">
            

            

            <code class="ruby">      return redirect_to users_login_path</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="53">
            

            

            <code class="ruby">    end</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="54">
            
              <span class="hits">1</span>
            

            

            <code class="ruby">    flash[:alert] = &#39;User not found from the given email&#39;</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="55">
            
              <span class="hits">1</span>
            

            

            <code class="ruby">    redirect_to forgot_password_path</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="56">
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="57">
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="58">
            
              <span class="hits">1</span>
            

            

            <code class="ruby">  def reset_password</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="59">
            

            

            <code class="ruby">    @user = User.find_by_reset_password_token(params[:token])</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="60">
            

            

            <code class="ruby">    if @user.nil? || @user.invalid_reset_password_token?</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="61">
            

            

            <code class="ruby">      flash[:alert] = &#39;Invalid or expired reset link&#39;</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="62">
            

            

            <code class="ruby">      redirect_to users_login_path</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="63">
            

            

            <code class="ruby">    end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="64">
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="65">
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="66">
            
              <span class="hits">1</span>
            

            

            <code class="ruby">  def update_password</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="67">
            

            

            <code class="ruby">    @user = User.find_by_reset_password_token(params[:token])</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="68">
            

            

            <code class="ruby">    if params[:new_password] != params[:confirm_new_password]</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="69">
            

            

            <code class="ruby">      flash[:alert] = &#39;Password confirmation must match&#39;</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="70">
            

            

            <code class="ruby">      return redirect_to new_user_path</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="71">
            

            

            <code class="ruby">    end</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="72">
            

            

            <code class="ruby">    if @user.update_password(params[:new_password])</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="73">
            

            

            <code class="ruby">      flash[:notice] = &#39;Password reset successful&#39;</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="74">
            

            

            <code class="ruby">      return redirect_to users_login_path</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="75">
            

            

            <code class="ruby">    end</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="76">
            

            

            <code class="ruby">    flash[:alert] = @user.errors.empty? ? &#39;Something went wrong&#39; : @user.errors.full_messages.first</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="77">
            

            

            <code class="ruby">    redirect_to reset_password_path</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="78">
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="79">
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="80">
            
              <span class="hits">1</span>
            

            

            <code class="ruby">  def get_session</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="3" data-linenumber="81">
            
              <span class="hits">3</span>
            

            

            <code class="ruby">    @user = User.find_user_by_display_name(params[:user_name])</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="3" data-linenumber="82">
            
              <span class="hits">3</span>
            

            

            <code class="ruby">    if @user &amp;&amp; @user.authenticate(params[:password]) &amp;&amp; @user.update_session_token</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="83">
            
              <span class="hits">1</span>
            

            

            <code class="ruby">      flash[:notice] = &#39;Login successful&#39;</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="84">
            
              <span class="hits">1</span>
            

            

            <code class="ruby">      cookies[:session] = { value: @user.session_token, expires: 1.week.from_now }</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="85">
            
              <span class="hits">1</span>
            

            

            <code class="ruby">      return redirect_to worlds_path</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="86">
            

            

            <code class="ruby">    end</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="2" data-linenumber="87">
            
              <span class="hits">2</span>
            

            

            <code class="ruby">    flash[:notice] = &#39;Incorrect username or password&#39;</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="88">
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
<<<<<<< HEAD
          <li class="covered" data-hits="2" data-linenumber="89">
=======
          <li class="covered" data-hits="2" data-linenumber="88">
>>>>>>> da2c136166f7c28bb78c4064cea4e4d3464ce5e3
            
              <span class="hits">2</span>
            

            

            <code class="ruby">    redirect_to users_login_path</code>
          </li>
        </div>
      
        <div>
<<<<<<< HEAD
          <li class="never" data-hits="" data-linenumber="90">
=======
          <li class="never" data-hits="" data-linenumber="89">
>>>>>>> da2c136166f7c28bb78c4064cea4e4d3464ce5e3
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
<<<<<<< HEAD
          <li class="never" data-hits="" data-linenumber="91">
=======
          <li class="never" data-hits="" data-linenumber="90">
>>>>>>> da2c136166f7c28bb78c4064cea4e4d3464ce5e3
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
<<<<<<< HEAD
          <li class="covered" data-hits="1" data-linenumber="92">
=======
          <li class="covered" data-hits="1" data-linenumber="91">
>>>>>>> da2c136166f7c28bb78c4064cea4e4d3464ce5e3
            
              <span class="hits">1</span>
            

            

            <code class="ruby">  def purchase</code>
          </li>
        </div>
      
        <div>
<<<<<<< HEAD
          <li class="covered" data-hits="1" data-linenumber="93">
=======
          <li class="covered" data-hits="1" data-linenumber="92">
>>>>>>> da2c136166f7c28bb78c4064cea4e4d3464ce5e3
            
              <span class="hits">1</span>
            

            

            <code class="ruby">    @user = User.find_user_by_session_token(cookies[:session])</code>
          </li>
        </div>
      
        <div>
<<<<<<< HEAD
          <li class="never" data-hits="" data-linenumber="94">
=======
          <li class="never" data-hits="" data-linenumber="93">
>>>>>>> da2c136166f7c28bb78c4064cea4e4d3464ce5e3
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
<<<<<<< HEAD
          <li class="never" data-hits="" data-linenumber="95">
=======
          <li class="never" data-hits="" data-linenumber="94">
>>>>>>> da2c136166f7c28bb78c4064cea4e4d3464ce5e3
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
<<<<<<< HEAD
          <li class="covered" data-hits="1" data-linenumber="96">
=======
          <li class="covered" data-hits="1" data-linenumber="95">
>>>>>>> da2c136166f7c28bb78c4064cea4e4d3464ce5e3
            
              <span class="hits">1</span>
            

            

            <code class="ruby">  def conversion</code>
          </li>
        </div>
      
        <div>
<<<<<<< HEAD
          <li class="covered" data-hits="1" data-linenumber="97">
=======
          <li class="covered" data-hits="1" data-linenumber="96">
>>>>>>> da2c136166f7c28bb78c4064cea4e4d3464ce5e3
            
              <span class="hits">1</span>
            

            

            <code class="ruby">    shards = params[:shard_input_field]</code>
          </li>
        </div>
      
        <div>
<<<<<<< HEAD
          <li class="covered" data-hits="1" data-linenumber="98">
=======
          <li class="covered" data-hits="1" data-linenumber="97">
>>>>>>> da2c136166f7c28bb78c4064cea4e4d3464ce5e3
            
              <span class="hits">1</span>
            

            

            <code class="ruby">    currency = params[:currency]</code>
          </li>
        </div>
      
        <div>
<<<<<<< HEAD
          <li class="never" data-hits="" data-linenumber="99">
=======
          <li class="never" data-hits="" data-linenumber="98">
>>>>>>> da2c136166f7c28bb78c4064cea4e4d3464ce5e3
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
<<<<<<< HEAD
          <li class="covered" data-hits="1" data-linenumber="100">
=======
          <li class="covered" data-hits="1" data-linenumber="99">
>>>>>>> da2c136166f7c28bb78c4064cea4e4d3464ce5e3
            
              <span class="hits">1</span>
            

            

            <code class="ruby">    if shards == &quot;&quot;</code>
          </li>
        </div>
      
        <div>
<<<<<<< HEAD
          <li class="missed" data-hits="0" data-linenumber="101">
=======
          <li class="missed" data-hits="0" data-linenumber="100">
>>>>>>> da2c136166f7c28bb78c4064cea4e4d3464ce5e3
            

            

            <code class="ruby">      flash[:notice] = &#39;No amount of shard indicated.&#39;</code>
          </li>
        </div>
      
        <div>
<<<<<<< HEAD
          <li class="missed" data-hits="0" data-linenumber="102">
=======
          <li class="missed" data-hits="0" data-linenumber="101">
>>>>>>> da2c136166f7c28bb78c4064cea4e4d3464ce5e3
            

            

            <code class="ruby">      redirect_to users_purchase_path</code>
          </li>
        </div>
      
        <div>
<<<<<<< HEAD
          <li class="never" data-hits="" data-linenumber="103">
=======
          <li class="never" data-hits="" data-linenumber="102">
>>>>>>> da2c136166f7c28bb78c4064cea4e4d3464ce5e3
            

            

            <code class="ruby">    else</code>
          </li>
        </div>
      
        <div>
<<<<<<< HEAD
          <li class="never" data-hits="" data-linenumber="104">
            

            

            <code class="ruby">      begin</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="105">
=======
          <li class="covered" data-hits="1" data-linenumber="103">
>>>>>>> da2c136166f7c28bb78c4064cea4e4d3464ce5e3
            
              <span class="hits">1</span>
            

            

            <code class="ruby">        raise(ArgumentError) unless shards.match?(/\A\d+\z/)</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="104">
            
              <span class="hits">1</span>
            

            

            <code class="ruby">        flash.clear</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="105">
            
              <span class="hits">1</span>
            

            

            <code class="ruby">        @currency = currency.upcase</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="106">
            
              <span class="hits">1</span>
            

            

            <code class="ruby">        shard_usd_price = 0.75 # default price in USD</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="107">
            
              <span class="hits">1</span>
            

            

            <code class="ruby">        @rate = (ShardsHelper.get_shard_conversion(@currency) * shard_usd_price).round(2)</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="108">
            
              <span class="hits">1</span>
            

            

            <code class="ruby">        @amount = (Integer(shards) * @rate).round(2)</code>
          </li>
        </div>
      
        <div>
<<<<<<< HEAD
          <li class="covered" data-hits="1" data-linenumber="111">
            
              <span class="hits">1</span>
            

            

            <code class="ruby">        @num_of_shards = Integer(shards)</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="112">
=======
          <li class="never" data-hits="" data-linenumber="109">
>>>>>>> da2c136166f7c28bb78c4064cea4e4d3464ce5e3
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
<<<<<<< HEAD
          <li class="covered" data-hits="1" data-linenumber="113">
=======
          <li class="covered" data-hits="1" data-linenumber="110">
>>>>>>> da2c136166f7c28bb78c4064cea4e4d3464ce5e3
            
              <span class="hits">1</span>
            

            

            <code class="ruby">        respond_to do |format|</code>
          </li>
        </div>
      
        <div>
<<<<<<< HEAD
          <li class="covered" data-hits="1" data-linenumber="114">
=======
          <li class="covered" data-hits="1" data-linenumber="111">
>>>>>>> da2c136166f7c28bb78c4064cea4e4d3464ce5e3
            
              <span class="hits">1</span>
            

            

            <code class="ruby">          format.js</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="115">
            

            

            <code class="ruby">        end</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="116">
            

            

            <code class="ruby">      rescue ArgumentError</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="117">
            

            

            <code class="ruby">        flash[:notice] = &quot;Input is not a number. Please try again.&quot;</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="118">
            

            

            <code class="ruby">        redirect_to users_purchase_path</code>
          </li>
        </div>
      
        <div>
<<<<<<< HEAD
          <li class="never" data-hits="" data-linenumber="119">
=======
          <li class="never" data-hits="" data-linenumber="112">
>>>>>>> da2c136166f7c28bb78c4064cea4e4d3464ce5e3
            

            

            <code class="ruby">      end</code>
          </li>
        </div>
      
        <div>
<<<<<<< HEAD
          <li class="never" data-hits="" data-linenumber="120">
=======
          <li class="never" data-hits="" data-linenumber="113">
>>>>>>> da2c136166f7c28bb78c4064cea4e4d3464ce5e3
            

            

            <code class="ruby">    end</code>
          </li>
        </div>
      
        <div>
<<<<<<< HEAD
          <li class="never" data-hits="" data-linenumber="121">
=======
          <li class="never" data-hits="" data-linenumber="114">
>>>>>>> da2c136166f7c28bb78c4064cea4e4d3464ce5e3
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
<<<<<<< HEAD
          <li class="never" data-hits="" data-linenumber="122">
=======
          <li class="never" data-hits="" data-linenumber="115">
>>>>>>> da2c136166f7c28bb78c4064cea4e4d3464ce5e3
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
<<<<<<< HEAD
          <li class="covered" data-hits="1" data-linenumber="123">
=======
          <li class="covered" data-hits="1" data-linenumber="116">
>>>>>>> da2c136166f7c28bb78c4064cea4e4d3464ce5e3
            
              <span class="hits">1</span>
            

            

            <code class="ruby">  def checkout</code>
          </li>
        </div>
      
        <div>
<<<<<<< HEAD
          <li class="covered" data-hits="1" data-linenumber="124">
=======
          <li class="covered" data-hits="1" data-linenumber="117">
>>>>>>> da2c136166f7c28bb78c4064cea4e4d3464ce5e3
            
              <span class="hits">1</span>
            

            

            <code class="ruby">    @total_amount = params[:total_amount]</code>
          </li>
        </div>
      
        <div>
<<<<<<< HEAD
          <li class="covered" data-hits="1" data-linenumber="125">
=======
          <li class="covered" data-hits="1" data-linenumber="118">
>>>>>>> da2c136166f7c28bb78c4064cea4e4d3464ce5e3
            
              <span class="hits">1</span>
            

            

            <code class="ruby">    @with_currency = params[:with_currency]</code>
          </li>
        </div>
      
        <div>
<<<<<<< HEAD
          <li class="covered" data-hits="1" data-linenumber="126">
=======
          <li class="covered" data-hits="1" data-linenumber="119">
>>>>>>> da2c136166f7c28bb78c4064cea4e4d3464ce5e3
            
              <span class="hits">1</span>
            

            

            <code class="ruby">    @num_of_shards = params[:total_shards]</code>
          </li>
        </div>
      
        <div>
<<<<<<< HEAD
          <li class="covered" data-hits="1" data-linenumber="127">
=======
          <li class="covered" data-hits="1" data-linenumber="120">
>>>>>>> da2c136166f7c28bb78c4064cea4e4d3464ce5e3
            
              <span class="hits">1</span>
            

            

            <code class="ruby">    @user = User.find_user_by_session_token(cookies[:session])</code>
          </li>
        </div>
      
        <div>
<<<<<<< HEAD
          <li class="never" data-hits="" data-linenumber="128">
=======
          <li class="never" data-hits="" data-linenumber="121">
>>>>>>> da2c136166f7c28bb78c4064cea4e4d3464ce5e3
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
<<<<<<< HEAD
          <li class="never" data-hits="" data-linenumber="129">
=======
          <li class="never" data-hits="" data-linenumber="122">
>>>>>>> da2c136166f7c28bb78c4064cea4e4d3464ce5e3
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
<<<<<<< HEAD
          <li class="covered" data-hits="1" data-linenumber="130">
=======
          <li class="covered" data-hits="1" data-linenumber="123">
>>>>>>> da2c136166f7c28bb78c4064cea4e4d3464ce5e3
            
              <span class="hits">1</span>
            

            

            <code class="ruby">  def payment</code>
          </li>
        </div>
      
        <div>
<<<<<<< HEAD
          <li class="covered" data-hits="7" data-linenumber="131">
=======
          <li class="covered" data-hits="7" data-linenumber="124">
>>>>>>> da2c136166f7c28bb78c4064cea4e4d3464ce5e3
            
              <span class="hits">7</span>
            

            

            <code class="ruby">    card_number = params[:card_number]</code>
          </li>
        </div>
      
        <div>
<<<<<<< HEAD
          <li class="covered" data-hits="7" data-linenumber="132">
=======
          <li class="covered" data-hits="7" data-linenumber="125">
>>>>>>> da2c136166f7c28bb78c4064cea4e4d3464ce5e3
            
              <span class="hits">7</span>
            

            

            <code class="ruby">    expiration_date = params[:expiration_date]</code>
          </li>
        </div>
      
        <div>
<<<<<<< HEAD
          <li class="covered" data-hits="7" data-linenumber="133">
=======
          <li class="covered" data-hits="7" data-linenumber="126">
>>>>>>> da2c136166f7c28bb78c4064cea4e4d3464ce5e3
            
              <span class="hits">7</span>
            

            

            <code class="ruby">    cvv = params[:cvv]</code>
          </li>
        </div>
      
        <div>
<<<<<<< HEAD
          <li class="covered" data-hits="7" data-linenumber="134">
=======
          <li class="covered" data-hits="7" data-linenumber="127">
>>>>>>> da2c136166f7c28bb78c4064cea4e4d3464ce5e3
            
              <span class="hits">7</span>
            

            

            <code class="ruby">    billing_address = params[:billing_address]</code>
          </li>
        </div>
      
        <div>
<<<<<<< HEAD
          <li class="covered" data-hits="7" data-linenumber="135">
=======
          <li class="covered" data-hits="7" data-linenumber="128">
>>>>>>> da2c136166f7c28bb78c4064cea4e4d3464ce5e3
            
              <span class="hits">7</span>
            

            

            <code class="ruby">    num_of_shards = Integer(if params[:total_shards] == &quot;&quot; then 0 else params[:total_shards] end)</code>
          </li>
        </div>
      
        <div>
<<<<<<< HEAD
          <li class="covered" data-hits="7" data-linenumber="136">
=======
          <li class="covered" data-hits="7" data-linenumber="129">
>>>>>>> da2c136166f7c28bb78c4064cea4e4d3464ce5e3
            
              <span class="hits">7</span>
            

            

            <code class="ruby">    @user = User.find_user_by_session_token(cookies[:session])</code>
          </li>
        </div>
      
        <div>
<<<<<<< HEAD
          <li class="never" data-hits="" data-linenumber="137">
=======
          <li class="never" data-hits="" data-linenumber="130">
>>>>>>> da2c136166f7c28bb78c4064cea4e4d3464ce5e3
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
<<<<<<< HEAD
          <li class="covered" data-hits="7" data-linenumber="138">
=======
          <li class="covered" data-hits="7" data-linenumber="131">
>>>>>>> da2c136166f7c28bb78c4064cea4e4d3464ce5e3
            
              <span class="hits">7</span>
            

            

            <code class="ruby">    if card_number == &quot;&quot; or expiration_date == &quot;&quot; or cvv == &quot;&quot; or billing_address == &quot;&quot;</code>
          </li>
        </div>
      
        <div>
<<<<<<< HEAD
          <li class="covered" data-hits="1" data-linenumber="139">
=======
          <li class="covered" data-hits="1" data-linenumber="132">
>>>>>>> da2c136166f7c28bb78c4064cea4e4d3464ce5e3
            
              <span class="hits">1</span>
            

            

            <code class="ruby">      @message = &quot;There is an error on processing. Please check your fields are correct.&quot;</code>
          </li>
        </div>
      
        <div>
<<<<<<< HEAD
          <li class="covered" data-hits="1" data-linenumber="140">
=======
          <li class="covered" data-hits="1" data-linenumber="133">
>>>>>>> da2c136166f7c28bb78c4064cea4e4d3464ce5e3
            
              <span class="hits">1</span>
            

            

            <code class="ruby">      respond_to do |format|</code>
          </li>
        </div>
      
        <div>
<<<<<<< HEAD
          <li class="covered" data-hits="1" data-linenumber="141">
=======
          <li class="covered" data-hits="1" data-linenumber="134">
>>>>>>> da2c136166f7c28bb78c4064cea4e4d3464ce5e3
            
              <span class="hits">1</span>
            

            

            <code class="ruby">        format.js</code>
          </li>
        </div>
      
        <div>
<<<<<<< HEAD
          <li class="never" data-hits="" data-linenumber="142">
=======
          <li class="never" data-hits="" data-linenumber="135">
>>>>>>> da2c136166f7c28bb78c4064cea4e4d3464ce5e3
            

            

            <code class="ruby">      end</code>
          </li>
        </div>
      
        <div>
<<<<<<< HEAD
          <li class="never" data-hits="" data-linenumber="143">
=======
          <li class="never" data-hits="" data-linenumber="136">
>>>>>>> da2c136166f7c28bb78c4064cea4e4d3464ce5e3
            

            

            <code class="ruby">    else</code>
          </li>
        </div>
      
        <div>
<<<<<<< HEAD
          <li class="covered" data-hits="6" data-linenumber="144">
=======
          <li class="covered" data-hits="6" data-linenumber="137">
>>>>>>> da2c136166f7c28bb78c4064cea4e4d3464ce5e3
            
              <span class="hits">6</span>
            

            

            <code class="ruby">      detector = CreditCardDetector::Detector.new(card_number)</code>
          </li>
        </div>
      
        <div>
<<<<<<< HEAD
          <li class="covered" data-hits="6" data-linenumber="145">
=======
          <li class="covered" data-hits="6" data-linenumber="138">
>>>>>>> da2c136166f7c28bb78c4064cea4e4d3464ce5e3
            
              <span class="hits">6</span>
            

            

            <code class="ruby">      result = detector.valid_luhn?</code>
          </li>
        </div>
      
        <div>
<<<<<<< HEAD
          <li class="covered" data-hits="6" data-linenumber="146">
=======
          <li class="covered" data-hits="6" data-linenumber="139">
>>>>>>> da2c136166f7c28bb78c4064cea4e4d3464ce5e3
            
              <span class="hits">6</span>
            

            

            <code class="ruby">      unless result</code>
          </li>
        </div>
      
        <div>
<<<<<<< HEAD
          <li class="covered" data-hits="1" data-linenumber="147">
=======
          <li class="covered" data-hits="1" data-linenumber="140">
>>>>>>> da2c136166f7c28bb78c4064cea4e4d3464ce5e3
            
              <span class="hits">1</span>
            

            

            <code class="ruby">        @message = &quot;Card number is not valid. Please recheck your card number.&quot;</code>
          </li>
        </div>
      
        <div>
<<<<<<< HEAD
          <li class="covered" data-hits="1" data-linenumber="148">
=======
          <li class="covered" data-hits="1" data-linenumber="141">
>>>>>>> da2c136166f7c28bb78c4064cea4e4d3464ce5e3
            
              <span class="hits">1</span>
            

            

            <code class="ruby">        respond_to do |format|</code>
          </li>
        </div>
      
        <div>
<<<<<<< HEAD
          <li class="covered" data-hits="1" data-linenumber="149">
=======
          <li class="covered" data-hits="1" data-linenumber="142">
>>>>>>> da2c136166f7c28bb78c4064cea4e4d3464ce5e3
            
              <span class="hits">1</span>
            

            

            <code class="ruby">          format.js</code>
          </li>
        </div>
      
        <div>
<<<<<<< HEAD
          <li class="never" data-hits="" data-linenumber="150">
=======
          <li class="never" data-hits="" data-linenumber="143">
>>>>>>> da2c136166f7c28bb78c4064cea4e4d3464ce5e3
            

            

            <code class="ruby">        end</code>
          </li>
        </div>
      
        <div>
<<<<<<< HEAD
          <li class="covered" data-hits="1" data-linenumber="151">
=======
          <li class="covered" data-hits="1" data-linenumber="144">
>>>>>>> da2c136166f7c28bb78c4064cea4e4d3464ce5e3
            
              <span class="hits">1</span>
            

            

            <code class="ruby">        return</code>
          </li>
        </div>
      
        <div>
<<<<<<< HEAD
          <li class="never" data-hits="" data-linenumber="152">
=======
          <li class="never" data-hits="" data-linenumber="145">
>>>>>>> da2c136166f7c28bb78c4064cea4e4d3464ce5e3
            

            

            <code class="ruby">      end</code>
          </li>
        </div>
      
        <div>
<<<<<<< HEAD
          <li class="covered" data-hits="5" data-linenumber="153">
=======
          <li class="covered" data-hits="5" data-linenumber="146">
>>>>>>> da2c136166f7c28bb78c4064cea4e4d3464ce5e3
            
              <span class="hits">5</span>
            

            

            <code class="ruby">      unless expiration_date =~ /\A\d\d\d\d\Z/</code>
          </li>
        </div>
      
        <div>
<<<<<<< HEAD
          <li class="covered" data-hits="1" data-linenumber="154">
=======
          <li class="covered" data-hits="1" data-linenumber="147">
>>>>>>> da2c136166f7c28bb78c4064cea4e4d3464ce5e3
            
              <span class="hits">1</span>
            

            

            <code class="ruby">        @message = &quot;Expiration date can only be 4 digits. Please try again.&quot;</code>
          </li>
        </div>
      
        <div>
<<<<<<< HEAD
          <li class="covered" data-hits="1" data-linenumber="155">
=======
          <li class="covered" data-hits="1" data-linenumber="148">
>>>>>>> da2c136166f7c28bb78c4064cea4e4d3464ce5e3
            
              <span class="hits">1</span>
            

            

            <code class="ruby">        respond_to do |format|</code>
          </li>
        </div>
      
        <div>
<<<<<<< HEAD
          <li class="covered" data-hits="1" data-linenumber="156">
=======
          <li class="covered" data-hits="1" data-linenumber="149">
>>>>>>> da2c136166f7c28bb78c4064cea4e4d3464ce5e3
            
              <span class="hits">1</span>
            

            

            <code class="ruby">          format.js</code>
          </li>
        </div>
      
        <div>
<<<<<<< HEAD
          <li class="never" data-hits="" data-linenumber="157">
=======
          <li class="never" data-hits="" data-linenumber="150">
>>>>>>> da2c136166f7c28bb78c4064cea4e4d3464ce5e3
            

            

            <code class="ruby">        end</code>
          </li>
        </div>
      
        <div>
<<<<<<< HEAD
          <li class="covered" data-hits="1" data-linenumber="158">
=======
          <li class="covered" data-hits="1" data-linenumber="151">
>>>>>>> da2c136166f7c28bb78c4064cea4e4d3464ce5e3
            
              <span class="hits">1</span>
            

            

            <code class="ruby">        return</code>
          </li>
        </div>
      
        <div>
<<<<<<< HEAD
          <li class="never" data-hits="" data-linenumber="159">
=======
          <li class="never" data-hits="" data-linenumber="152">
>>>>>>> da2c136166f7c28bb78c4064cea4e4d3464ce5e3
            

            

            <code class="ruby">      end</code>
          </li>
        </div>
      
        <div>
<<<<<<< HEAD
          <li class="covered" data-hits="4" data-linenumber="160">
=======
          <li class="covered" data-hits="4" data-linenumber="153">
>>>>>>> da2c136166f7c28bb78c4064cea4e4d3464ce5e3
            
              <span class="hits">4</span>
            

            

            <code class="ruby">      unless cvv =~ /\A\d\d\d\Z/</code>
          </li>
        </div>
      
        <div>
<<<<<<< HEAD
          <li class="covered" data-hits="1" data-linenumber="161">
=======
          <li class="covered" data-hits="1" data-linenumber="154">
>>>>>>> da2c136166f7c28bb78c4064cea4e4d3464ce5e3
            
              <span class="hits">1</span>
            

            

            <code class="ruby">        @message = &quot;CVV can only be 3 digits. Please try again.&quot;</code>
          </li>
        </div>
      
        <div>
<<<<<<< HEAD
          <li class="covered" data-hits="1" data-linenumber="162">
=======
          <li class="covered" data-hits="1" data-linenumber="155">
>>>>>>> da2c136166f7c28bb78c4064cea4e4d3464ce5e3
            
              <span class="hits">1</span>
            

            

            <code class="ruby">        respond_to do |format|</code>
          </li>
        </div>
      
        <div>
<<<<<<< HEAD
          <li class="covered" data-hits="1" data-linenumber="163">
=======
          <li class="covered" data-hits="1" data-linenumber="156">
>>>>>>> da2c136166f7c28bb78c4064cea4e4d3464ce5e3
            
              <span class="hits">1</span>
            

            

            <code class="ruby">          format.js</code>
          </li>
        </div>
      
        <div>
<<<<<<< HEAD
          <li class="never" data-hits="" data-linenumber="164">
=======
          <li class="never" data-hits="" data-linenumber="157">
>>>>>>> da2c136166f7c28bb78c4064cea4e4d3464ce5e3
            

            

            <code class="ruby">        end</code>
          </li>
        </div>
      
        <div>
<<<<<<< HEAD
          <li class="covered" data-hits="1" data-linenumber="165">
=======
          <li class="covered" data-hits="1" data-linenumber="158">
>>>>>>> da2c136166f7c28bb78c4064cea4e4d3464ce5e3
            
              <span class="hits">1</span>
            

            

            <code class="ruby">        return</code>
          </li>
        </div>
      
        <div>
<<<<<<< HEAD
          <li class="never" data-hits="" data-linenumber="166">
=======
          <li class="never" data-hits="" data-linenumber="159">
>>>>>>> da2c136166f7c28bb78c4064cea4e4d3464ce5e3
            

            

            <code class="ruby">      end</code>
          </li>
        </div>
      
        <div>
<<<<<<< HEAD
          <li class="covered" data-hits="3" data-linenumber="167">
=======
          <li class="covered" data-hits="3" data-linenumber="160">
>>>>>>> da2c136166f7c28bb78c4064cea4e4d3464ce5e3
            
              <span class="hits">3</span>
            

            

            <code class="ruby">      @user.update(available_credits: @user.available_credits + num_of_shards)</code>
          </li>
        </div>
      
        <div>
<<<<<<< HEAD
          <li class="covered" data-hits="3" data-linenumber="168">
=======
          <li class="covered" data-hits="3" data-linenumber="161">
>>>>>>> da2c136166f7c28bb78c4064cea4e4d3464ce5e3
            
              <span class="hits">3</span>
            

            

            <code class="ruby">      redirect_to users_purchase_path</code>
          </li>
        </div>
      
        <div>
<<<<<<< HEAD
          <li class="never" data-hits="" data-linenumber="169">
=======
          <li class="never" data-hits="" data-linenumber="162">
>>>>>>> da2c136166f7c28bb78c4064cea4e4d3464ce5e3
            

            

            <code class="ruby">    end</code>
          </li>
        </div>
      
        <div>
<<<<<<< HEAD
          <li class="never" data-hits="" data-linenumber="170">
=======
          <li class="never" data-hits="" data-linenumber="163">
>>>>>>> da2c136166f7c28bb78c4064cea4e4d3464ce5e3
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
<<<<<<< HEAD
          <li class="never" data-hits="" data-linenumber="171">
=======
          <li class="never" data-hits="" data-linenumber="164">
>>>>>>> da2c136166f7c28bb78c4064cea4e4d3464ce5e3
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
<<<<<<< HEAD
          <li class="covered" data-hits="1" data-linenumber="172">
=======
          <li class="covered" data-hits="1" data-linenumber="165">
>>>>>>> da2c136166f7c28bb78c4064cea4e4d3464ce5e3
            
              <span class="hits">1</span>
            

            

            <code class="ruby">  def logout</code>
          </li>
        </div>
      
        <div>
<<<<<<< HEAD
          <li class="covered" data-hits="1" data-linenumber="173">
=======
          <li class="covered" data-hits="1" data-linenumber="166">
>>>>>>> da2c136166f7c28bb78c4064cea4e4d3464ce5e3
            
              <span class="hits">1</span>
            

            

            <code class="ruby">    cur_user = User.find_user_by_session_token(cookies[:session])</code>
          </li>
        </div>
      
        <div>
<<<<<<< HEAD
          <li class="covered" data-hits="1" data-linenumber="174">
=======
          <li class="covered" data-hits="1" data-linenumber="167">
>>>>>>> da2c136166f7c28bb78c4064cea4e4d3464ce5e3
            
              <span class="hits">1</span>
            

            

            <code class="ruby">    flash[:notice] = &#39;Logout successful&#39;</code>
          </li>
        </div>
      
        <div>
<<<<<<< HEAD
          <li class="covered" data-hits="1" data-linenumber="175">
=======
          <li class="covered" data-hits="1" data-linenumber="168">
>>>>>>> da2c136166f7c28bb78c4064cea4e4d3464ce5e3
            
              <span class="hits">1</span>
            

            

            <code class="ruby">    cur_user.session_token = nil</code>
          </li>
        </div>
      
        <div>
<<<<<<< HEAD
          <li class="covered" data-hits="1" data-linenumber="176">
=======
          <li class="covered" data-hits="1" data-linenumber="169">
>>>>>>> da2c136166f7c28bb78c4064cea4e4d3464ce5e3
            
              <span class="hits">1</span>
            

            

            <code class="ruby">    cur_user.save!</code>
          </li>
        </div>
      
        <div>
<<<<<<< HEAD
          <li class="covered" data-hits="1" data-linenumber="177">
=======
          <li class="covered" data-hits="1" data-linenumber="170">
>>>>>>> da2c136166f7c28bb78c4064cea4e4d3464ce5e3
            
              <span class="hits">1</span>
            

            

            <code class="ruby">    redirect_to users_login_path</code>
          </li>
        </div>
      
        <div>
<<<<<<< HEAD
          <li class="never" data-hits="" data-linenumber="178">
=======
          <li class="never" data-hits="" data-linenumber="171">
>>>>>>> da2c136166f7c28bb78c4064cea4e4d3464ce5e3
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
<<<<<<< HEAD
          <li class="never" data-hits="" data-linenumber="179">
=======
          <li class="never" data-hits="" data-linenumber="172">
>>>>>>> da2c136166f7c28bb78c4064cea4e4d3464ce5e3
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
<<<<<<< HEAD
          <li class="covered" data-hits="1" data-linenumber="180">
=======
          <li class="covered" data-hits="1" data-linenumber="173">
>>>>>>> da2c136166f7c28bb78c4064cea4e4d3464ce5e3
            
              <span class="hits">1</span>
            

            

            <code class="ruby">  def add_friend</code>
          </li>
        </div>
      
        <div>
<<<<<<< HEAD
          <li class="covered" data-hits="4" data-linenumber="181">
=======
          <li class="covered" data-hits="4" data-linenumber="174">
>>>>>>> da2c136166f7c28bb78c4064cea4e4d3464ce5e3
            
              <span class="hits">4</span>
            

            

            <code class="ruby">    cur_user = User.find_user_by_session_token(cookies[:session])</code>
          </li>
        </div>
      
        <div>
<<<<<<< HEAD
          <li class="covered" data-hits="4" data-linenumber="182">
=======
          <li class="covered" data-hits="4" data-linenumber="175">
>>>>>>> da2c136166f7c28bb78c4064cea4e4d3464ce5e3
            
              <span class="hits">4</span>
            

            

            <code class="ruby">    friend_name = params[:friend_name]</code>
          </li>
        </div>
      
        <div>
<<<<<<< HEAD
          <li class="covered" data-hits="4" data-linenumber="183">
=======
          <li class="covered" data-hits="4" data-linenumber="176">
>>>>>>> da2c136166f7c28bb78c4064cea4e4d3464ce5e3
            
              <span class="hits">4</span>
            

            

            <code class="ruby">    @friend = User.find_by(display_name: friend_name)</code>
          </li>
        </div>
      
        <div>
<<<<<<< HEAD
          <li class="never" data-hits="" data-linenumber="184">
=======
          <li class="never" data-hits="" data-linenumber="177">
>>>>>>> da2c136166f7c28bb78c4064cea4e4d3464ce5e3
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
<<<<<<< HEAD
          <li class="covered" data-hits="4" data-linenumber="185">
=======
          <li class="covered" data-hits="4" data-linenumber="178">
>>>>>>> da2c136166f7c28bb78c4064cea4e4d3464ce5e3
            
              <span class="hits">4</span>
            

            

            <code class="ruby">    if @friend.nil?</code>
          </li>
        </div>
      
        <div>
<<<<<<< HEAD
          <li class="covered" data-hits="1" data-linenumber="186">
=======
          <li class="covered" data-hits="1" data-linenumber="179">
>>>>>>> da2c136166f7c28bb78c4064cea4e4d3464ce5e3
            
              <span class="hits">1</span>
            

            

            <code class="ruby">      @message = &quot;User not found.&quot;</code>
          </li>
        </div>
      
        <div>
<<<<<<< HEAD
          <li class="covered" data-hits="1" data-linenumber="187">
=======
          <li class="covered" data-hits="1" data-linenumber="180">
>>>>>>> da2c136166f7c28bb78c4064cea4e4d3464ce5e3
            
              <span class="hits">1</span>
            

            

            <code class="ruby">      respond_to do |format|</code>
          </li>
        </div>
      
        <div>
<<<<<<< HEAD
          <li class="covered" data-hits="1" data-linenumber="188">
=======
          <li class="covered" data-hits="1" data-linenumber="181">
>>>>>>> da2c136166f7c28bb78c4064cea4e4d3464ce5e3
            
              <span class="hits">1</span>
            

            

            <code class="ruby">        format.js</code>
          </li>
        </div>
      
        <div>
<<<<<<< HEAD
          <li class="never" data-hits="" data-linenumber="189">
=======
          <li class="never" data-hits="" data-linenumber="182">
>>>>>>> da2c136166f7c28bb78c4064cea4e4d3464ce5e3
            

            

            <code class="ruby">      end</code>
          </li>
        </div>
      
        <div>
<<<<<<< HEAD
          <li class="covered" data-hits="3" data-linenumber="190">
=======
          <li class="covered" data-hits="3" data-linenumber="183">
>>>>>>> da2c136166f7c28bb78c4064cea4e4d3464ce5e3
            
              <span class="hits">3</span>
            

            

            <code class="ruby">    elsif @friend == cur_user</code>
          </li>
        </div>
      
        <div>
<<<<<<< HEAD
          <li class="covered" data-hits="1" data-linenumber="191">
=======
          <li class="covered" data-hits="1" data-linenumber="184">
>>>>>>> da2c136166f7c28bb78c4064cea4e4d3464ce5e3
            
              <span class="hits">1</span>
            

            

            <code class="ruby">      @message = &quot;Unfortunately, you cannot add yourself as a friend.&quot;</code>
          </li>
        </div>
      
        <div>
<<<<<<< HEAD
          <li class="covered" data-hits="1" data-linenumber="192">
=======
          <li class="covered" data-hits="1" data-linenumber="185">
>>>>>>> da2c136166f7c28bb78c4064cea4e4d3464ce5e3
            
              <span class="hits">1</span>
            

            

            <code class="ruby">      respond_to do |format|</code>
          </li>
        </div>
      
        <div>
<<<<<<< HEAD
          <li class="covered" data-hits="1" data-linenumber="193">
=======
          <li class="covered" data-hits="1" data-linenumber="186">
>>>>>>> da2c136166f7c28bb78c4064cea4e4d3464ce5e3
            
              <span class="hits">1</span>
            

            

            <code class="ruby">        format.js</code>
          </li>
        </div>
      
        <div>
<<<<<<< HEAD
          <li class="never" data-hits="" data-linenumber="194">
=======
          <li class="never" data-hits="" data-linenumber="187">
>>>>>>> da2c136166f7c28bb78c4064cea4e4d3464ce5e3
            

            

            <code class="ruby">      end</code>
          </li>
        </div>
      
        <div>
<<<<<<< HEAD
          <li class="never" data-hits="" data-linenumber="195">
=======
          <li class="never" data-hits="" data-linenumber="188">
>>>>>>> da2c136166f7c28bb78c4064cea4e4d3464ce5e3
            

            

            <code class="ruby">    else</code>
          </li>
        </div>
      
        <div>
<<<<<<< HEAD
          <li class="covered" data-hits="2" data-linenumber="196">
=======
          <li class="covered" data-hits="2" data-linenumber="189">
>>>>>>> da2c136166f7c28bb78c4064cea4e4d3464ce5e3
            
              <span class="hits">2</span>
            

            

            <code class="ruby">      existing_friendship = Friendship.find_by(user_id: cur_user.id, friend_id: @friend.id, status: &#39;accepted&#39;)</code>
          </li>
        </div>
      
        <div>
<<<<<<< HEAD
          <li class="covered" data-hits="2" data-linenumber="197">
=======
          <li class="covered" data-hits="2" data-linenumber="190">
>>>>>>> da2c136166f7c28bb78c4064cea4e4d3464ce5e3
            
              <span class="hits">2</span>
            

            

            <code class="ruby">      inverse_friendship = Friendship.find_by(user_id: @friend.id, friend_id: cur_user.id, status: &#39;accepted&#39;)</code>
          </li>
        </div>
      
        <div>
<<<<<<< HEAD
          <li class="never" data-hits="" data-linenumber="198">
=======
          <li class="never" data-hits="" data-linenumber="191">
>>>>>>> da2c136166f7c28bb78c4064cea4e4d3464ce5e3
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
<<<<<<< HEAD
          <li class="covered" data-hits="2" data-linenumber="199">
=======
          <li class="covered" data-hits="2" data-linenumber="192">
>>>>>>> da2c136166f7c28bb78c4064cea4e4d3464ce5e3
            
              <span class="hits">2</span>
            

            

            <code class="ruby">      existing_request = Friendship.find_by(user_id: cur_user.id, friend_id: @friend.id, status: &#39;pending&#39;)</code>
          </li>
        </div>
      
        <div>
<<<<<<< HEAD
          <li class="covered" data-hits="2" data-linenumber="200">
=======
          <li class="covered" data-hits="2" data-linenumber="193">
>>>>>>> da2c136166f7c28bb78c4064cea4e4d3464ce5e3
            
              <span class="hits">2</span>
            

            

            <code class="ruby">      inverse_request = Friendship.find_by(user_id: @friend.id, friend_id: cur_user.id, status: &#39;pending&#39;)</code>
          </li>
        </div>
      
        <div>
<<<<<<< HEAD
          <li class="never" data-hits="" data-linenumber="201">
=======
          <li class="never" data-hits="" data-linenumber="194">
>>>>>>> da2c136166f7c28bb78c4064cea4e4d3464ce5e3
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
<<<<<<< HEAD
          <li class="covered" data-hits="2" data-linenumber="202">
=======
          <li class="covered" data-hits="2" data-linenumber="195">
>>>>>>> da2c136166f7c28bb78c4064cea4e4d3464ce5e3
            
              <span class="hits">2</span>
            

            

            <code class="ruby">      if existing_friendship || inverse_friendship</code>
          </li>
        </div>
      
        <div>
<<<<<<< HEAD
          <li class="missed" data-hits="0" data-linenumber="203">
=======
          <li class="missed" data-hits="0" data-linenumber="196">
>>>>>>> da2c136166f7c28bb78c4064cea4e4d3464ce5e3
            

            

            <code class="ruby">        @message = &quot;Friendship already exists!&quot;</code>
          </li>
        </div>
      
        <div>
<<<<<<< HEAD
          <li class="missed" data-hits="0" data-linenumber="204">
=======
          <li class="missed" data-hits="0" data-linenumber="197">
>>>>>>> da2c136166f7c28bb78c4064cea4e4d3464ce5e3
            

            

            <code class="ruby">        respond_to do |format|</code>
          </li>
        </div>
      
        <div>
<<<<<<< HEAD
          <li class="missed" data-hits="0" data-linenumber="205">
=======
          <li class="missed" data-hits="0" data-linenumber="198">
>>>>>>> da2c136166f7c28bb78c4064cea4e4d3464ce5e3
            

            

            <code class="ruby">          format.js</code>
          </li>
        </div>
      
        <div>
<<<<<<< HEAD
          <li class="never" data-hits="" data-linenumber="206">
=======
          <li class="never" data-hits="" data-linenumber="199">
>>>>>>> da2c136166f7c28bb78c4064cea4e4d3464ce5e3
            

            

            <code class="ruby">        end</code>
          </li>
        </div>
      
        <div>
<<<<<<< HEAD
          <li class="covered" data-hits="2" data-linenumber="207">
=======
          <li class="covered" data-hits="2" data-linenumber="200">
>>>>>>> da2c136166f7c28bb78c4064cea4e4d3464ce5e3
            
              <span class="hits">2</span>
            

            

            <code class="ruby">      elsif existing_request</code>
          </li>
        </div>
      
        <div>
<<<<<<< HEAD
          <li class="missed" data-hits="0" data-linenumber="208">
=======
          <li class="missed" data-hits="0" data-linenumber="201">
>>>>>>> da2c136166f7c28bb78c4064cea4e4d3464ce5e3
            

            

            <code class="ruby">        @message = &quot;A request has already been sent!&quot;</code>
          </li>
        </div>
      
        <div>
<<<<<<< HEAD
          <li class="missed" data-hits="0" data-linenumber="209">
=======
          <li class="missed" data-hits="0" data-linenumber="202">
>>>>>>> da2c136166f7c28bb78c4064cea4e4d3464ce5e3
            

            

            <code class="ruby">        respond_to do |format|</code>
          </li>
        </div>
      
        <div>
<<<<<<< HEAD
          <li class="missed" data-hits="0" data-linenumber="210">
=======
          <li class="missed" data-hits="0" data-linenumber="203">
>>>>>>> da2c136166f7c28bb78c4064cea4e4d3464ce5e3
            

            

            <code class="ruby">          format.js</code>
          </li>
        </div>
      
        <div>
<<<<<<< HEAD
          <li class="never" data-hits="" data-linenumber="211">
=======
          <li class="never" data-hits="" data-linenumber="204">
>>>>>>> da2c136166f7c28bb78c4064cea4e4d3464ce5e3
            

            

            <code class="ruby">        end</code>
          </li>
        </div>
      
        <div>
<<<<<<< HEAD
          <li class="covered" data-hits="2" data-linenumber="212">
=======
          <li class="covered" data-hits="2" data-linenumber="205">
>>>>>>> da2c136166f7c28bb78c4064cea4e4d3464ce5e3
            
              <span class="hits">2</span>
            

            

            <code class="ruby">      elsif inverse_request</code>
          </li>
        </div>
      
        <div>
<<<<<<< HEAD
          <li class="missed" data-hits="0" data-linenumber="213">
=======
          <li class="missed" data-hits="0" data-linenumber="206">
>>>>>>> da2c136166f7c28bb78c4064cea4e4d3464ce5e3
            

            

            <code class="ruby">        @message = &quot;This person has sent a request to you already!&quot;</code>
          </li>
        </div>
      
        <div>
<<<<<<< HEAD
          <li class="missed" data-hits="0" data-linenumber="214">
=======
          <li class="missed" data-hits="0" data-linenumber="207">
>>>>>>> da2c136166f7c28bb78c4064cea4e4d3464ce5e3
            

            

            <code class="ruby">        respond_to do |format|</code>
          </li>
        </div>
      
        <div>
<<<<<<< HEAD
          <li class="missed" data-hits="0" data-linenumber="215">
=======
          <li class="missed" data-hits="0" data-linenumber="208">
>>>>>>> da2c136166f7c28bb78c4064cea4e4d3464ce5e3
            

            

            <code class="ruby">          format.js</code>
          </li>
        </div>
      
        <div>
<<<<<<< HEAD
          <li class="never" data-hits="" data-linenumber="216">
=======
          <li class="never" data-hits="" data-linenumber="209">
>>>>>>> da2c136166f7c28bb78c4064cea4e4d3464ce5e3
            

            

            <code class="ruby">        end</code>
          </li>
        </div>
      
        <div>
<<<<<<< HEAD
          <li class="never" data-hits="" data-linenumber="217">
=======
          <li class="never" data-hits="" data-linenumber="210">
>>>>>>> da2c136166f7c28bb78c4064cea4e4d3464ce5e3
            

            

            <code class="ruby">      else</code>
          </li>
        </div>
      
        <div>
<<<<<<< HEAD
          <li class="covered" data-hits="2" data-linenumber="218">
=======
          <li class="covered" data-hits="2" data-linenumber="211">
>>>>>>> da2c136166f7c28bb78c4064cea4e4d3464ce5e3
            
              <span class="hits">2</span>
            

            

            <code class="ruby">        friendship = Friendship.new(user_id: cur_user.id, friend_id: @friend.id, status: &#39;pending&#39;)</code>
          </li>
        </div>
      
        <div>
<<<<<<< HEAD
          <li class="never" data-hits="" data-linenumber="219">
=======
          <li class="never" data-hits="" data-linenumber="212">
>>>>>>> da2c136166f7c28bb78c4064cea4e4d3464ce5e3
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
<<<<<<< HEAD
          <li class="covered" data-hits="2" data-linenumber="220">
=======
          <li class="covered" data-hits="2" data-linenumber="213">
>>>>>>> da2c136166f7c28bb78c4064cea4e4d3464ce5e3
            
              <span class="hits">2</span>
            

            

            <code class="ruby">        if friendship.save</code>
          </li>
        </div>
      
        <div>
<<<<<<< HEAD
          <li class="covered" data-hits="1" data-linenumber="221">
=======
          <li class="covered" data-hits="1" data-linenumber="214">
>>>>>>> da2c136166f7c28bb78c4064cea4e4d3464ce5e3
            
              <span class="hits">1</span>
            

            

            <code class="ruby">          @message = &quot;A friend request has been sent!&quot;</code>
          </li>
        </div>
      
        <div>
<<<<<<< HEAD
          <li class="covered" data-hits="1" data-linenumber="222">
=======
          <li class="covered" data-hits="1" data-linenumber="215">
>>>>>>> da2c136166f7c28bb78c4064cea4e4d3464ce5e3
            
              <span class="hits">1</span>
            

            

            <code class="ruby">          respond_to do |format|</code>
          </li>
        </div>
      
        <div>
<<<<<<< HEAD
          <li class="covered" data-hits="1" data-linenumber="223">
=======
          <li class="covered" data-hits="1" data-linenumber="216">
>>>>>>> da2c136166f7c28bb78c4064cea4e4d3464ce5e3
            
              <span class="hits">1</span>
            

            

            <code class="ruby">            format.js</code>
          </li>
        </div>
      
        <div>
<<<<<<< HEAD
          <li class="never" data-hits="" data-linenumber="224">
=======
          <li class="never" data-hits="" data-linenumber="217">
>>>>>>> da2c136166f7c28bb78c4064cea4e4d3464ce5e3
            

            

            <code class="ruby">          end</code>
          </li>
        </div>
      
        <div>
<<<<<<< HEAD
          <li class="never" data-hits="" data-linenumber="225">
=======
          <li class="never" data-hits="" data-linenumber="218">
>>>>>>> da2c136166f7c28bb78c4064cea4e4d3464ce5e3
            

            

            <code class="ruby">        else</code>
          </li>
        </div>
      
        <div>
<<<<<<< HEAD
          <li class="covered" data-hits="1" data-linenumber="226">
=======
          <li class="covered" data-hits="1" data-linenumber="219">
>>>>>>> da2c136166f7c28bb78c4064cea4e4d3464ce5e3
            
              <span class="hits">1</span>
            

            

            <code class="ruby">          @message = &quot;Failed to add friendship.&quot;</code>
          </li>
        </div>
      
        <div>
<<<<<<< HEAD
          <li class="covered" data-hits="1" data-linenumber="227">
=======
          <li class="covered" data-hits="1" data-linenumber="220">
>>>>>>> da2c136166f7c28bb78c4064cea4e4d3464ce5e3
            
              <span class="hits">1</span>
            

            

            <code class="ruby">          respond_to do |format|</code>
          </li>
        </div>
      
        <div>
<<<<<<< HEAD
          <li class="covered" data-hits="1" data-linenumber="228">
=======
          <li class="covered" data-hits="1" data-linenumber="221">
>>>>>>> da2c136166f7c28bb78c4064cea4e4d3464ce5e3
            
              <span class="hits">1</span>
            

            

            <code class="ruby">            format.js</code>
          </li>
        </div>
      
        <div>
<<<<<<< HEAD
          <li class="never" data-hits="" data-linenumber="229">
=======
          <li class="never" data-hits="" data-linenumber="222">
>>>>>>> da2c136166f7c28bb78c4064cea4e4d3464ce5e3
            

            

            <code class="ruby">          end</code>
          </li>
        </div>
      
        <div>
<<<<<<< HEAD
          <li class="never" data-hits="" data-linenumber="230">
=======
          <li class="never" data-hits="" data-linenumber="223">
>>>>>>> da2c136166f7c28bb78c4064cea4e4d3464ce5e3
            

            

            <code class="ruby">        end</code>
          </li>
        </div>
      
        <div>
<<<<<<< HEAD
          <li class="never" data-hits="" data-linenumber="231">
=======
          <li class="never" data-hits="" data-linenumber="224">
>>>>>>> da2c136166f7c28bb78c4064cea4e4d3464ce5e3
            

            

            <code class="ruby">      end</code>
          </li>
        </div>
      
        <div>
<<<<<<< HEAD
          <li class="never" data-hits="" data-linenumber="232">
=======
          <li class="never" data-hits="" data-linenumber="225">
>>>>>>> da2c136166f7c28bb78c4064cea4e4d3464ce5e3
            

            

            <code class="ruby">    end</code>
          </li>
        </div>
      
        <div>
<<<<<<< HEAD
          <li class="never" data-hits="" data-linenumber="233">
=======
          <li class="never" data-hits="" data-linenumber="226">
>>>>>>> da2c136166f7c28bb78c4064cea4e4d3464ce5e3
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
<<<<<<< HEAD
          <li class="never" data-hits="" data-linenumber="234">
=======
          <li class="never" data-hits="" data-linenumber="227">
>>>>>>> da2c136166f7c28bb78c4064cea4e4d3464ce5e3
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
<<<<<<< HEAD
          <li class="covered" data-hits="1" data-linenumber="235">
=======
          <li class="covered" data-hits="1" data-linenumber="228">
>>>>>>> da2c136166f7c28bb78c4064cea4e4d3464ce5e3
            
              <span class="hits">1</span>
            

            

            <code class="ruby">  def delete_friend</code>
          </li>
        </div>
      
        <div>
<<<<<<< HEAD
          <li class="covered" data-hits="2" data-linenumber="236">
=======
          <li class="covered" data-hits="2" data-linenumber="229">
>>>>>>> da2c136166f7c28bb78c4064cea4e4d3464ce5e3
            
              <span class="hits">2</span>
            

            

            <code class="ruby">    cur_user = User.find_user_by_session_token(cookies[:session])</code>
          </li>
        </div>
      
        <div>
<<<<<<< HEAD
          <li class="covered" data-hits="2" data-linenumber="237">
=======
          <li class="covered" data-hits="2" data-linenumber="230">
>>>>>>> da2c136166f7c28bb78c4064cea4e4d3464ce5e3
            
              <span class="hits">2</span>
            

            

            <code class="ruby">    @friend = User.find_by(id: params[:friend_id])</code>
          </li>
        </div>
      
        <div>
<<<<<<< HEAD
          <li class="never" data-hits="" data-linenumber="238">
=======
          <li class="never" data-hits="" data-linenumber="231">
>>>>>>> da2c136166f7c28bb78c4064cea4e4d3464ce5e3
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
<<<<<<< HEAD
          <li class="covered" data-hits="2" data-linenumber="239">
=======
          <li class="covered" data-hits="2" data-linenumber="232">
>>>>>>> da2c136166f7c28bb78c4064cea4e4d3464ce5e3
            
              <span class="hits">2</span>
            

            

            <code class="ruby">    existing_friendship = Friendship.find_by(user_id: cur_user.id, friend_id: params[:friend_id])</code>
          </li>
        </div>
      
        <div>
<<<<<<< HEAD
          <li class="covered" data-hits="2" data-linenumber="240">
=======
          <li class="covered" data-hits="2" data-linenumber="233">
>>>>>>> da2c136166f7c28bb78c4064cea4e4d3464ce5e3
            
              <span class="hits">2</span>
            

            

            <code class="ruby">    inverse_friendship = Friendship.find_by(user_id: params[:friend_id], friend_id: cur_user.id)</code>
          </li>
        </div>
      
        <div>
<<<<<<< HEAD
          <li class="never" data-hits="" data-linenumber="241">
=======
          <li class="never" data-hits="" data-linenumber="234">
>>>>>>> da2c136166f7c28bb78c4064cea4e4d3464ce5e3
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
<<<<<<< HEAD
          <li class="covered" data-hits="2" data-linenumber="242">
=======
          <li class="covered" data-hits="2" data-linenumber="235">
>>>>>>> da2c136166f7c28bb78c4064cea4e4d3464ce5e3
            
              <span class="hits">2</span>
            

            

            <code class="ruby">    if existing_friendship</code>
          </li>
        </div>
      
        <div>
<<<<<<< HEAD
          <li class="covered" data-hits="2" data-linenumber="243">
=======
          <li class="covered" data-hits="2" data-linenumber="236">
>>>>>>> da2c136166f7c28bb78c4064cea4e4d3464ce5e3
            
              <span class="hits">2</span>
            

            

            <code class="ruby">      existing_friendship.destroy</code>
          </li>
        </div>
      
        <div>
<<<<<<< HEAD
          <li class="never" data-hits="" data-linenumber="244">
=======
          <li class="never" data-hits="" data-linenumber="237">
>>>>>>> da2c136166f7c28bb78c4064cea4e4d3464ce5e3
            

            

            <code class="ruby">    end</code>
          </li>
        </div>
      
        <div>
<<<<<<< HEAD
          <li class="covered" data-hits="2" data-linenumber="245">
=======
          <li class="covered" data-hits="2" data-linenumber="238">
>>>>>>> da2c136166f7c28bb78c4064cea4e4d3464ce5e3
            
              <span class="hits">2</span>
            

            

            <code class="ruby">    if inverse_friendship</code>
          </li>
        </div>
      
        <div>
<<<<<<< HEAD
          <li class="covered" data-hits="2" data-linenumber="246">
=======
          <li class="covered" data-hits="2" data-linenumber="239">
>>>>>>> da2c136166f7c28bb78c4064cea4e4d3464ce5e3
            
              <span class="hits">2</span>
            

            

            <code class="ruby">      inverse_friendship.destroy</code>
          </li>
        </div>
      
        <div>
<<<<<<< HEAD
          <li class="never" data-hits="" data-linenumber="247">
=======
          <li class="never" data-hits="" data-linenumber="240">
>>>>>>> da2c136166f7c28bb78c4064cea4e4d3464ce5e3
            

            

            <code class="ruby">    end</code>
          </li>
        </div>
      
        <div>
<<<<<<< HEAD
          <li class="covered" data-hits="2" data-linenumber="248">
=======
          <li class="covered" data-hits="2" data-linenumber="241">
>>>>>>> da2c136166f7c28bb78c4064cea4e4d3464ce5e3
            
              <span class="hits">2</span>
            

            

            <code class="ruby">    @message = &#39;Friend removed successfully.&#39;</code>
          </li>
        </div>
      
        <div>
<<<<<<< HEAD
          <li class="covered" data-hits="2" data-linenumber="249">
=======
          <li class="covered" data-hits="2" data-linenumber="242">
>>>>>>> da2c136166f7c28bb78c4064cea4e4d3464ce5e3
            
              <span class="hits">2</span>
            

            

            <code class="ruby">    respond_to do |format|</code>
          </li>
        </div>
      
        <div>
<<<<<<< HEAD
          <li class="covered" data-hits="2" data-linenumber="250">
=======
          <li class="covered" data-hits="2" data-linenumber="243">
>>>>>>> da2c136166f7c28bb78c4064cea4e4d3464ce5e3
            
              <span class="hits">2</span>
            

            

            <code class="ruby">      format.js</code>
          </li>
        </div>
      
        <div>
<<<<<<< HEAD
          <li class="never" data-hits="" data-linenumber="251">
=======
          <li class="never" data-hits="" data-linenumber="244">
>>>>>>> da2c136166f7c28bb78c4064cea4e4d3464ce5e3
            

            

            <code class="ruby">    end</code>
          </li>
        </div>
      
        <div>
<<<<<<< HEAD
          <li class="never" data-hits="" data-linenumber="252">
=======
          <li class="never" data-hits="" data-linenumber="245">
>>>>>>> da2c136166f7c28bb78c4064cea4e4d3464ce5e3
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
<<<<<<< HEAD
          <li class="never" data-hits="" data-linenumber="253">
=======
          <li class="never" data-hits="" data-linenumber="246">
>>>>>>> da2c136166f7c28bb78c4064cea4e4d3464ce5e3
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
<<<<<<< HEAD
          <li class="covered" data-hits="1" data-linenumber="254">
=======
          <li class="covered" data-hits="1" data-linenumber="247">
>>>>>>> da2c136166f7c28bb78c4064cea4e4d3464ce5e3
            
              <span class="hits">1</span>
            

            

            <code class="ruby">  def approve_request</code>
          </li>
        </div>
      
        <div>
<<<<<<< HEAD
          <li class="covered" data-hits="3" data-linenumber="255">
=======
          <li class="covered" data-hits="3" data-linenumber="248">
>>>>>>> da2c136166f7c28bb78c4064cea4e4d3464ce5e3
            
              <span class="hits">3</span>
            

            

            <code class="ruby">    cur_user = User.find_user_by_session_token(cookies[:session])</code>
          </li>
        </div>
      
        <div>
<<<<<<< HEAD
          <li class="covered" data-hits="3" data-linenumber="256">
=======
          <li class="covered" data-hits="3" data-linenumber="249">
>>>>>>> da2c136166f7c28bb78c4064cea4e4d3464ce5e3
            
              <span class="hits">3</span>
            

            

            <code class="ruby">    @friend = User.find_by(id: params[:friend_id])</code>
          </li>
        </div>
      
        <div>
<<<<<<< HEAD
          <li class="covered" data-hits="3" data-linenumber="257">
=======
          <li class="covered" data-hits="3" data-linenumber="250">
>>>>>>> da2c136166f7c28bb78c4064cea4e4d3464ce5e3
            
              <span class="hits">3</span>
            

            

            <code class="ruby">    existing_friendship = Friendship.find_by(user_id: cur_user.id, friend_id: params[:friend_id])</code>
          </li>
        </div>
      
        <div>
<<<<<<< HEAD
          <li class="covered" data-hits="3" data-linenumber="258">
=======
          <li class="covered" data-hits="3" data-linenumber="251">
>>>>>>> da2c136166f7c28bb78c4064cea4e4d3464ce5e3
            
              <span class="hits">3</span>
            

            

            <code class="ruby">    inverse_friendship = Friendship.find_by(user_id: params[:friend_id], friend_id: cur_user.id)</code>
          </li>
        </div>
      
        <div>
<<<<<<< HEAD
          <li class="never" data-hits="" data-linenumber="259">
=======
          <li class="never" data-hits="" data-linenumber="252">
>>>>>>> da2c136166f7c28bb78c4064cea4e4d3464ce5e3
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
<<<<<<< HEAD
          <li class="covered" data-hits="3" data-linenumber="260">
=======
          <li class="covered" data-hits="3" data-linenumber="253">
>>>>>>> da2c136166f7c28bb78c4064cea4e4d3464ce5e3
            
              <span class="hits">3</span>
            

            

            <code class="ruby">    friendship = existing_friendship || inverse_friendship</code>
          </li>
        </div>
      
        <div>
<<<<<<< HEAD
          <li class="covered" data-hits="3" data-linenumber="261">
=======
          <li class="covered" data-hits="3" data-linenumber="254">
>>>>>>> da2c136166f7c28bb78c4064cea4e4d3464ce5e3
            
              <span class="hits">3</span>
            

            

            <code class="ruby">    if friendship&amp;.update(status: &#39;accepted&#39;)</code>
          </li>
        </div>
      
        <div>
<<<<<<< HEAD
          <li class="covered" data-hits="1" data-linenumber="262">
=======
          <li class="covered" data-hits="1" data-linenumber="255">
>>>>>>> da2c136166f7c28bb78c4064cea4e4d3464ce5e3
            
              <span class="hits">1</span>
            

            

            <code class="ruby">      @message = &#39;Friend accepted!&#39;</code>
          </li>
        </div>
      
        <div>
<<<<<<< HEAD
          <li class="never" data-hits="" data-linenumber="263">
=======
          <li class="never" data-hits="" data-linenumber="256">
>>>>>>> da2c136166f7c28bb78c4064cea4e4d3464ce5e3
            

            

            <code class="ruby">    else</code>
          </li>
        </div>
      
        <div>
<<<<<<< HEAD
          <li class="covered" data-hits="2" data-linenumber="264">
=======
          <li class="covered" data-hits="2" data-linenumber="257">
>>>>>>> da2c136166f7c28bb78c4064cea4e4d3464ce5e3
            
              <span class="hits">2</span>
            

            

            <code class="ruby">      @message = &#39;Friendship not found!&#39;</code>
          </li>
        </div>
      
        <div>
<<<<<<< HEAD
          <li class="never" data-hits="" data-linenumber="265">
=======
          <li class="never" data-hits="" data-linenumber="258">
>>>>>>> da2c136166f7c28bb78c4064cea4e4d3464ce5e3
            

            

            <code class="ruby">    end</code>
          </li>
        </div>
      
        <div>
<<<<<<< HEAD
          <li class="never" data-hits="" data-linenumber="266">
=======
          <li class="never" data-hits="" data-linenumber="259">
>>>>>>> da2c136166f7c28bb78c4064cea4e4d3464ce5e3
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
<<<<<<< HEAD
          <li class="covered" data-hits="3" data-linenumber="267">
=======
          <li class="covered" data-hits="3" data-linenumber="260">
>>>>>>> da2c136166f7c28bb78c4064cea4e4d3464ce5e3
            
              <span class="hits">3</span>
            

            

            <code class="ruby">    respond_to do |format|</code>
          </li>
        </div>
      
        <div>
<<<<<<< HEAD
          <li class="covered" data-hits="3" data-linenumber="268">
=======
          <li class="covered" data-hits="3" data-linenumber="261">
>>>>>>> da2c136166f7c28bb78c4064cea4e4d3464ce5e3
            
              <span class="hits">3</span>
            

            

            <code class="ruby">      format.js</code>
          </li>
        </div>
      
        <div>
<<<<<<< HEAD
          <li class="never" data-hits="" data-linenumber="269">
=======
          <li class="never" data-hits="" data-linenumber="262">
>>>>>>> da2c136166f7c28bb78c4064cea4e4d3464ce5e3
            

            

            <code class="ruby">    end</code>
          </li>
        </div>
      
        <div>
<<<<<<< HEAD
          <li class="never" data-hits="" data-linenumber="270">
=======
          <li class="never" data-hits="" data-linenumber="263">
>>>>>>> da2c136166f7c28bb78c4064cea4e4d3464ce5e3
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
<<<<<<< HEAD
          <li class="never" data-hits="" data-linenumber="271">
=======
          <li class="never" data-hits="" data-linenumber="264">
>>>>>>> da2c136166f7c28bb78c4064cea4e4d3464ce5e3
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
<<<<<<< HEAD
          <li class="covered" data-hits="1" data-linenumber="272">
=======
          <li class="covered" data-hits="1" data-linenumber="265">
>>>>>>> da2c136166f7c28bb78c4064cea4e4d3464ce5e3
            
              <span class="hits">1</span>
            

            

            <code class="ruby">  def reject_request</code>
          </li>
        </div>
      
        <div>
<<<<<<< HEAD
          <li class="covered" data-hits="2" data-linenumber="273">
=======
          <li class="covered" data-hits="2" data-linenumber="266">
>>>>>>> da2c136166f7c28bb78c4064cea4e4d3464ce5e3
            
              <span class="hits">2</span>
            

            

            <code class="ruby">    cur_user = User.find_user_by_session_token(cookies[:session])</code>
          </li>
        </div>
      
        <div>
<<<<<<< HEAD
          <li class="covered" data-hits="2" data-linenumber="274">
=======
          <li class="covered" data-hits="2" data-linenumber="267">
>>>>>>> da2c136166f7c28bb78c4064cea4e4d3464ce5e3
            
              <span class="hits">2</span>
            

            

            <code class="ruby">    @friend = User.find_by(id: params[:friend_id])</code>
          </li>
        </div>
      
        <div>
<<<<<<< HEAD
          <li class="never" data-hits="" data-linenumber="275">
=======
          <li class="never" data-hits="" data-linenumber="268">
>>>>>>> da2c136166f7c28bb78c4064cea4e4d3464ce5e3
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
<<<<<<< HEAD
          <li class="covered" data-hits="2" data-linenumber="276">
=======
          <li class="covered" data-hits="2" data-linenumber="269">
>>>>>>> da2c136166f7c28bb78c4064cea4e4d3464ce5e3
            
              <span class="hits">2</span>
            

            

            <code class="ruby">    existing_friendship = Friendship.find_by(user_id: cur_user.id, friend_id: params[:friend_id])</code>
          </li>
        </div>
      
        <div>
<<<<<<< HEAD
          <li class="covered" data-hits="2" data-linenumber="277">
=======
          <li class="covered" data-hits="2" data-linenumber="270">
>>>>>>> da2c136166f7c28bb78c4064cea4e4d3464ce5e3
            
              <span class="hits">2</span>
            

            

            <code class="ruby">    inverse_friendship = Friendship.find_by(user_id: params[:friend_id], friend_id: cur_user.id)</code>
          </li>
        </div>
      
        <div>
<<<<<<< HEAD
          <li class="never" data-hits="" data-linenumber="278">
=======
          <li class="never" data-hits="" data-linenumber="271">
>>>>>>> da2c136166f7c28bb78c4064cea4e4d3464ce5e3
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
<<<<<<< HEAD
          <li class="covered" data-hits="2" data-linenumber="279">
=======
          <li class="covered" data-hits="2" data-linenumber="272">
>>>>>>> da2c136166f7c28bb78c4064cea4e4d3464ce5e3
            
              <span class="hits">2</span>
            

            

            <code class="ruby">    if existing_friendship</code>
          </li>
        </div>
      
        <div>
<<<<<<< HEAD
          <li class="missed" data-hits="0" data-linenumber="280">
=======
          <li class="missed" data-hits="0" data-linenumber="273">
>>>>>>> da2c136166f7c28bb78c4064cea4e4d3464ce5e3
            

            

            <code class="ruby">      existing_friendship.destroy</code>
          </li>
        </div>
      
        <div>
<<<<<<< HEAD
          <li class="never" data-hits="" data-linenumber="281">
=======
          <li class="never" data-hits="" data-linenumber="274">
>>>>>>> da2c136166f7c28bb78c4064cea4e4d3464ce5e3
            

            

            <code class="ruby">    end</code>
          </li>
        </div>
      
        <div>
<<<<<<< HEAD
          <li class="covered" data-hits="2" data-linenumber="282">
=======
          <li class="covered" data-hits="2" data-linenumber="275">
>>>>>>> da2c136166f7c28bb78c4064cea4e4d3464ce5e3
            
              <span class="hits">2</span>
            

            

            <code class="ruby">    if inverse_friendship</code>
          </li>
        </div>
      
        <div>
<<<<<<< HEAD
          <li class="missed" data-hits="0" data-linenumber="283">
=======
          <li class="missed" data-hits="0" data-linenumber="276">
>>>>>>> da2c136166f7c28bb78c4064cea4e4d3464ce5e3
            

            

            <code class="ruby">      inverse_friendship.destroy</code>
          </li>
        </div>
      
        <div>
<<<<<<< HEAD
          <li class="never" data-hits="" data-linenumber="284">
=======
          <li class="never" data-hits="" data-linenumber="277">
>>>>>>> da2c136166f7c28bb78c4064cea4e4d3464ce5e3
            

            

            <code class="ruby">    end</code>
          </li>
        </div>
      
        <div>
<<<<<<< HEAD
          <li class="covered" data-hits="2" data-linenumber="285">
=======
          <li class="covered" data-hits="2" data-linenumber="278">
>>>>>>> da2c136166f7c28bb78c4064cea4e4d3464ce5e3
            
              <span class="hits">2</span>
            

            

            <code class="ruby">    @message = &#39;Friend request declined.&#39;</code>
          </li>
        </div>
      
        <div>
<<<<<<< HEAD
          <li class="covered" data-hits="2" data-linenumber="286">
=======
          <li class="covered" data-hits="2" data-linenumber="279">
>>>>>>> da2c136166f7c28bb78c4064cea4e4d3464ce5e3
            
              <span class="hits">2</span>
            

            

            <code class="ruby">    respond_to do |format|</code>
          </li>
        </div>
      
        <div>
<<<<<<< HEAD
          <li class="covered" data-hits="2" data-linenumber="287">
=======
          <li class="covered" data-hits="2" data-linenumber="280">
>>>>>>> da2c136166f7c28bb78c4064cea4e4d3464ce5e3
            
              <span class="hits">2</span>
            

            

            <code class="ruby">      format.js</code>
          </li>
        </div>
      
        <div>
<<<<<<< HEAD
          <li class="never" data-hits="" data-linenumber="288">
=======
          <li class="never" data-hits="" data-linenumber="281">
>>>>>>> da2c136166f7c28bb78c4064cea4e4d3464ce5e3
            

            

            <code class="ruby">    end</code>
          </li>
        </div>
      
        <div>
<<<<<<< HEAD
          <li class="never" data-hits="" data-linenumber="289">
=======
          <li class="never" data-hits="" data-linenumber="282">
>>>>>>> da2c136166f7c28bb78c4064cea4e4d3464ce5e3
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
<<<<<<< HEAD
          <li class="never" data-hits="" data-linenumber="290">
=======
          <li class="never" data-hits="" data-linenumber="283">
>>>>>>> da2c136166f7c28bb78c4064cea4e4d3464ce5e3
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
<<<<<<< HEAD
          <li class="covered" data-hits="1" data-linenumber="291">
=======
          <li class="covered" data-hits="1" data-linenumber="284">
>>>>>>> da2c136166f7c28bb78c4064cea4e4d3464ce5e3
            
              <span class="hits">1</span>
            

            

            <code class="ruby">  def purchase_plus_user_view</code>
          </li>
        </div>
      
        <div>
<<<<<<< HEAD
          <li class="missed" data-hits="0" data-linenumber="292">
=======
          <li class="missed" data-hits="0" data-linenumber="285">
>>>>>>> da2c136166f7c28bb78c4064cea4e4d3464ce5e3
            

            

            <code class="ruby">    @user = User.find_user_by_session_token(cookies[:session])</code>
          </li>
        </div>
      
        <div>
<<<<<<< HEAD
          <li class="never" data-hits="" data-linenumber="293">
=======
          <li class="never" data-hits="" data-linenumber="286">
>>>>>>> da2c136166f7c28bb78c4064cea4e4d3464ce5e3
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
<<<<<<< HEAD
          <li class="never" data-hits="" data-linenumber="294">
=======
          <li class="never" data-hits="" data-linenumber="287">
>>>>>>> da2c136166f7c28bb78c4064cea4e4d3464ce5e3
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
<<<<<<< HEAD
          <li class="covered" data-hits="1" data-linenumber="295">
=======
          <li class="covered" data-hits="1" data-linenumber="288">
>>>>>>> da2c136166f7c28bb78c4064cea4e4d3464ce5e3
            
              <span class="hits">1</span>
            

            

            <code class="ruby">  def purchase_plus_user</code>
          </li>
        </div>
      
        <div>
<<<<<<< HEAD
          <li class="covered" data-hits="1" data-linenumber="296">
=======
          <li class="covered" data-hits="1" data-linenumber="289">
>>>>>>> da2c136166f7c28bb78c4064cea4e4d3464ce5e3
            
              <span class="hits">1</span>
            

            

            <code class="ruby">    @user = User.find_user_by_session_token(cookies[:session])</code>
          </li>
        </div>
      
        <div>
<<<<<<< HEAD
          <li class="covered" data-hits="1" data-linenumber="297">
=======
          <li class="covered" data-hits="1" data-linenumber="290">
>>>>>>> da2c136166f7c28bb78c4064cea4e4d3464ce5e3
            
              <span class="hits">1</span>
            

            

            <code class="ruby">    if @user.plus_user?</code>
          </li>
        </div>
      
        <div>
<<<<<<< HEAD
          <li class="covered" data-hits="1" data-linenumber="298">
=======
          <li class="covered" data-hits="1" data-linenumber="291">
>>>>>>> da2c136166f7c28bb78c4064cea4e4d3464ce5e3
            
              <span class="hits">1</span>
            

            

            <code class="ruby">      flash[:alert] = &#39;You already have Plus User access&#39;</code>
          </li>
        </div>
      
        <div>
<<<<<<< HEAD
          <li class="missed" data-hits="0" data-linenumber="299">
=======
          <li class="missed" data-hits="0" data-linenumber="292">
>>>>>>> da2c136166f7c28bb78c4064cea4e4d3464ce5e3
            

            

            <code class="ruby">    elsif @user.purchase_plus_user</code>
          </li>
        </div>
      
        <div>
<<<<<<< HEAD
          <li class="missed" data-hits="0" data-linenumber="300">
=======
          <li class="missed" data-hits="0" data-linenumber="293">
>>>>>>> da2c136166f7c28bb78c4064cea4e4d3464ce5e3
            

            

            <code class="ruby">      flash[:notice] = &#39;Plus user access purchased successfully&#39;</code>
          </li>
        </div>
      
        <div>
<<<<<<< HEAD
          <li class="never" data-hits="" data-linenumber="301">
=======
          <li class="never" data-hits="" data-linenumber="294">
>>>>>>> da2c136166f7c28bb78c4064cea4e4d3464ce5e3
            

            

            <code class="ruby">    else</code>
          </li>
        </div>
      
        <div>
<<<<<<< HEAD
          <li class="missed" data-hits="0" data-linenumber="302">
=======
          <li class="missed" data-hits="0" data-linenumber="295">
>>>>>>> da2c136166f7c28bb78c4064cea4e4d3464ce5e3
            

            

            <code class="ruby">      flash[:alert] = &#39;Not enough shards to purchase plus user access&#39;</code>
          </li>
        </div>
      
        <div>
<<<<<<< HEAD
          <li class="never" data-hits="" data-linenumber="303">
=======
          <li class="never" data-hits="" data-linenumber="296">
>>>>>>> da2c136166f7c28bb78c4064cea4e4d3464ce5e3
            

            

            <code class="ruby">    end</code>
          </li>
        </div>
      
        <div>
<<<<<<< HEAD
          <li class="covered" data-hits="1" data-linenumber="304">
=======
          <li class="covered" data-hits="1" data-linenumber="297">
>>>>>>> da2c136166f7c28bb78c4064cea4e4d3464ce5e3
            
              <span class="hits">1</span>
            

            

            <code class="ruby">    redirect_to worlds_path</code>
          </li>
        </div>
      
        <div>
<<<<<<< HEAD
          <li class="never" data-hits="" data-linenumber="305">
=======
          <li class="never" data-hits="" data-linenumber="298">
>>>>>>> da2c136166f7c28bb78c4064cea4e4d3464ce5e3
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
<<<<<<< HEAD
          <li class="never" data-hits="" data-linenumber="306">
=======
          <li class="never" data-hits="" data-linenumber="299">
>>>>>>> da2c136166f7c28bb78c4064cea4e4d3464ce5e3
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
<<<<<<< HEAD
          <li class="never" data-hits="" data-linenumber="307">
=======
          <li class="never" data-hits="" data-linenumber="300">
>>>>>>> da2c136166f7c28bb78c4064cea4e4d3464ce5e3
            

            

            <code class="ruby">end</code>
          </li>
        </div>
      
    </ol>
  </pre>
</div>

      
        <div class="source_table" id="1b4728b25b121f825e3cbd762599532a0e3f5013">
  <div class="header">
    <h3>app/controllers/users_worlds_controller.rb</h3>
    <h4>
      <span class="green">
  92.0%
</span>

      lines covered
    </h4>

    

    <div class="t-line-summary">
      <b>25</b> relevant lines.
      <span class="green"><b>23</b> lines covered</span> and
      <span class="red"><b>2</b> lines missed.</span>
    </div>

    

  </div>

  <pre>
    <ol>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1">
            

            

            <code class="ruby"># frozen_string_literal: true</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="2">
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="3">
            

            

            <code class="ruby"># Controller for handling user-world actions.</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="4">
            
              <span class="hits">1</span>
            

            

            <code class="ruby">class UsersWorldsController &lt; ApplicationController</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="5">
            
              <span class="hits">1</span>
            

            

            <code class="ruby">  before_action :authenticate_user</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="6">
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="7">
            
              <span class="hits">1</span>
            

            

            <code class="ruby">  def authenticate_user</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="3" data-linenumber="8">
            
              <span class="hits">3</span>
            

            

            <code class="ruby">    @cur_user = User.find_user_by_session_token(cookies[:session])</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="3" data-linenumber="9">
            
              <span class="hits">3</span>
            

            

            <code class="ruby">    return if @cur_user</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="10">
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="11">
            

            

            <code class="ruby">    flash[:alert] = &#39;Please login&#39;</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="12">
            

            

            <code class="ruby">    redirect_to users_login_path</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="13">
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="14">
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="15">
            
              <span class="hits">1</span>
            

            

            <code class="ruby">  def cell_quest</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="16">
            
              <span class="hits">1</span>
            

            

            <code class="ruby">    @cur_user = User.find_user_by_session_token(cookies[:session])</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="17">
            
              <span class="hits">1</span>
            

            

            <code class="ruby">    @world = World.find(params[:world_id])</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="18">
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="19">
            
              <span class="hits">1</span>
            

            

            <code class="ruby">    @user_world = UserWorld.find_by_ids(@cur_user.id, @world.id)</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="20">
            
              <span class="hits">1</span>
            

            

            <code class="ruby">    Rails.logger.debug(&#39;Enter quest log&#39;)</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="21">
            
              <span class="hits">1</span>
            

            

            <code class="ruby">    Rails.logger.debug(@user_world.xp)</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="22">
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="23">
            

            

            <code class="ruby">    # {respond_to do |format|</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="24">
            

            

            <code class="ruby">    #  format.js</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="25">
            

            

            <code class="ruby">    # end}</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="26">
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="27">
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="28">
            
              <span class="hits">1</span>
            

            

            <code class="ruby">  def cell_action</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="29">
            
              <span class="hits">1</span>
            

            

            <code class="ruby">    @cur_user = User.find_user_by_session_token(cookies[:session])</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="30">
            
              <span class="hits">1</span>
            

            

            <code class="ruby">    @world = World.find(params[:world_id])</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="31">
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="32">
            
              <span class="hits">1</span>
            

            

            <code class="ruby">    @user_world = UserWorld.find_by_ids(@cur_user.id, @world.id)</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="33">
            
              <span class="hits">1</span>
            

            

            <code class="ruby">    Rails.logger.debug(&#39;Enter action&#39;)</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="34">
            
              <span class="hits">1</span>
            

            

            <code class="ruby">    Rails.logger.debug(@user_world.xp)</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="35">
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="36">
            

            

            <code class="ruby">    # {respond_to do |format|</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="37">
            

            

            <code class="ruby">    #  format.js</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="38">
            

            

            <code class="ruby">    # end}</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="39">
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="40">
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="41">
            
              <span class="hits">1</span>
            

            

            <code class="ruby">  def cell_shop</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="42">
            
              <span class="hits">1</span>
            

            

            <code class="ruby">    @cur_user = User.find_user_by_session_token(cookies[:session])</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="43">
            
              <span class="hits">1</span>
            

            

            <code class="ruby">    @world = World.find(params[:world_id])</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="44">
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="45">
            
              <span class="hits">1</span>
            

            

            <code class="ruby">    @user_world = UserWorld.find_by_ids(@cur_user.id, @world.id)</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="46">
            
              <span class="hits">1</span>
            

            

            <code class="ruby">    Rails.logger.debug(&#39;Enter shop&#39;)</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="47">
            
              <span class="hits">1</span>
            

            

            <code class="ruby">    Rails.logger.debug(@user_world.xp)</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="48">
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="49">
            

            

            <code class="ruby">    # {respond_to do |format|</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="50">
            

            

            <code class="ruby">    #  format.js</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="51">
            

            

            <code class="ruby">    # end}</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="52">
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="53">
            

            

            <code class="ruby">end</code>
          </li>
        </div>
      
    </ol>
  </pre>
</div>

      
        <div class="source_table" id="2cc59cbd4ca9886ff1431a2b08cee804fd811074">
  <div class="header">
    <h3>app/controllers/worlds_controller.rb</h3>
    <h4>
      <span class="green">
  96.92%
</span>

      lines covered
    </h4>

    

    <div class="t-line-summary">
      <b>65</b> relevant lines.
      <span class="green"><b>63</b> lines covered</span> and
      <span class="red"><b>2</b> lines missed.</span>
    </div>

    

  </div>

  <pre>
    <ol>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1">
            

            

            <code class="ruby"># frozen_string_literal: true</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="2">
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="3">
            

            

            <code class="ruby"># WorldController performs basic operations for world generation and state storage.</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="4">
            

            

            <code class="ruby"># rubocop:disable all</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="5">
            
              <span class="hits">1</span>
            

            

            <code class="ruby">class WorldsController &lt; ApplicationController</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="6">
            
              <span class="hits">1</span>
            

            

            <code class="ruby">  before_action :authenticate_user</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="7">
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="8">
            
              <span class="hits">1</span>
            

            

            <code class="ruby">  def authenticate_user</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="11" data-linenumber="9">
            
              <span class="hits">11</span>
            

            

            <code class="ruby">    @cur_user = User.find_user_by_session_token(cookies[:session])</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="11" data-linenumber="10">
            
              <span class="hits">11</span>
            

            

            <code class="ruby">    return if @cur_user</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="11">
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="12">
            
              <span class="hits">1</span>
            

            

            <code class="ruby">    flash[:alert] = &#39;Please login&#39;</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="13">
            
              <span class="hits">1</span>
            

            

            <code class="ruby">    redirect_to users_login_path</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="14">
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="15">
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="16">
            
              <span class="hits">1</span>
            

            

            <code class="ruby">  def world_params</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="2" data-linenumber="17">
            
              <span class="hits">2</span>
            

            

            <code class="ruby">    params.permit(:world_code, :world_name, :is_public, :max_player)</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="18">
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="19">
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="20">
            
              <span class="hits">1</span>
            

            

            <code class="ruby">  def show</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="21">
            

            

            <code class="ruby">    # TODO: if private world, check user access</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="22">
            
              <span class="hits">1</span>
            

            

            <code class="ruby">    id = params[:id] # retrieve world ID from URI route</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="23">
            
              <span class="hits">1</span>
            

            

            <code class="ruby">    @world = World.find(id)</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="24">
            
              <span class="hits">1</span>
            

            

            <code class="ruby">    @world.init_if_not_inited</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="25">
            
              <span class="hits">1</span>
            

            

            <code class="ruby">    @data = {}</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="26">
            
              <span class="hits">1</span>
            

            

            <code class="ruby">    grid_arr = @world.gridsquares.to_ary</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="27">
            
              <span class="hits">1</span>
            

            

            <code class="ruby">    grid_arr.each do |cell|</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="28">
            
              <span class="hits">1</span>
            

            

            <code class="ruby">      @data[cell.row] ||= {}</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="29">
            
              <span class="hits">1</span>
            

            

            <code class="ruby">      @data[cell.row][cell.col] = cell</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="30">
            

            

            <code class="ruby">    end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="31">
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="32">
            
              <span class="hits">1</span>
            

            

            <code class="ruby">    @cur_user = User.find_user_by_session_token(cookies[:session])</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="33">
            
              <span class="hits">1</span>
            

            

            <code class="ruby">    @user_world = UserWorld.find_by_ids(@cur_user.id, @world.id)</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="34">
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="35">
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="36">
            
              <span class="hits">1</span>
            

            

            <code class="ruby">  def index</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="37">
            
              <span class="hits">1</span>
            

            

            <code class="ruby">    flash.discard</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="38">
            
              <span class="hits">1</span>
            

            

            <code class="ruby">    @public_worlds = World.where(is_public: true)</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="39">
            
              <span class="hits">1</span>
            

            

            <code class="ruby">    @private_worlds = World.where(is_public: false)</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="40">
            
              <span class="hits">1</span>
            

            

            <code class="ruby">    @friends = User.where(id: Friendship.friend_ids(@cur_user))</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="41">
            
              <span class="hits">1</span>
            

            

            <code class="ruby">    @requested_friends = User.where(id: Friendship.requested_friend_ids(@cur_user))</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="42">
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="43">
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="44">
            
              <span class="hits">1</span>
            

            

            <code class="ruby">  def new</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="45">
            
              <span class="hits">1</span>
            

            

            <code class="ruby">    @cur_user = User.find_user_by_session_token(cookies[:session])</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="46">
            

            

            <code class="ruby">    # default: render &#39;new&#39; template</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="47">
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="48">
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="49">
            
              <span class="hits">1</span>
            

            

            <code class="ruby">  def create</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="2" data-linenumber="50">
            
              <span class="hits">2</span>
            

            

            <code class="ruby">    new_params = build_world_params</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="51">
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="2" data-linenumber="52">
            
              <span class="hits">2</span>
            

            

            <code class="ruby">    if invalid_world_params?(new_params)</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="53">
            
              <span class="hits">1</span>
            

            

            <code class="ruby">      flash[:notice] =</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="54">
            

            

            <code class="ruby">        &#39;You have exceeded the worlds player limit. If you would like to upgrade from 5 to 20 purchase plus user.&#39;</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="55">
            
              <span class="hits">1</span>
            

            

            <code class="ruby">      redirect_to new_world_path</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="56">
            

            

            <code class="ruby">    else</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="57">
            
              <span class="hits">1</span>
            

            

            <code class="ruby">      @world = World.create!(new_params)</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="58">
            
              <span class="hits">1</span>
            

            

            <code class="ruby">      flash[:notice] = &#39;World was successfully created.&#39;</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="59">
            
              <span class="hits">1</span>
            

            

            <code class="ruby">      redirect_to worlds_path</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="60">
            

            

            <code class="ruby">    end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="61">
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="62">
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="63">
            
              <span class="hits">1</span>
            

            

            <code class="ruby">  def edit; end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="64">
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="65">
            
              <span class="hits">1</span>
            

            

            <code class="ruby">  def update; end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="66">
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="67">
            
              <span class="hits">1</span>
            

            

            <code class="ruby">  def destroy; end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="68">
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="69">
            
              <span class="hits">1</span>
            

            

            <code class="ruby">  def join_world</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="3" data-linenumber="70">
            
              <span class="hits">3</span>
            

            

            <code class="ruby">    @selected_world = World.find(params[:id].split(&#39;_&#39;)[1])</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="3" data-linenumber="71">
            
              <span class="hits">3</span>
            

            

            <code class="ruby">    UserWorld.find_or_create_by(user: @cur_user, world: @selected_world)</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="72">
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="3" data-linenumber="73">
            
              <span class="hits">3</span>
            

            

            <code class="ruby">    if @selected_world.current_players &gt;= @selected_world.max_player.to_i</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="74">
            
              <span class="hits">1</span>
            

            

            <code class="ruby">      flash[:notice] = &#39;World is full. Please join another world.&#39;</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="75">
            
              <span class="hits">1</span>
            

            

            <code class="ruby">      redirect_to worlds_path</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="76">
            

            

            <code class="ruby">    else</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="2" data-linenumber="77">
            
              <span class="hits">2</span>
            

            

            <code class="ruby">      @selected_world.update(current_players: @selected_world.current_players + 1)</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="2" data-linenumber="78">
            
              <span class="hits">2</span>
            

            

            <code class="ruby">      redirect_to world_path(@selected_world)</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="79">
            

            

            <code class="ruby">    end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="80">
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="81">
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="82">
            
              <span class="hits">1</span>
            

            

            <code class="ruby">  def add_world</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="83">
            

            

            <code class="ruby">    @world = World.create!(new_params)</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="84">
            

            

            <code class="ruby">    redirect_to new_world_path</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="85">
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="86">
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="87">
            
              <span class="hits">1</span>
            

            

            <code class="ruby">  def leave_world</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="2" data-linenumber="88">
            
              <span class="hits">2</span>
            

            

            <code class="ruby">    @selected_world = World.find(params[:id])</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="2" data-linenumber="89">
            
              <span class="hits">2</span>
            

            

            <code class="ruby">    UserWorld.find_by(user: @cur_user, world: @selected_world)</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="90">
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="2" data-linenumber="91">
            
              <span class="hits">2</span>
            

            

            <code class="ruby">    if @selected_world.current_players.positive?</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="2" data-linenumber="92">
            
              <span class="hits">2</span>
            

            

            <code class="ruby">      @selected_world.update(current_players: @selected_world.current_players - 1)</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="93">
            

            

            <code class="ruby">    end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="94">
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="2" data-linenumber="95">
            
              <span class="hits">2</span>
            

            

            <code class="ruby">    redirect_to worlds_path</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="96">
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="97">
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="98">
            
              <span class="hits">1</span>
            

            

            <code class="ruby">  private</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="99">
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="100">
            
              <span class="hits">1</span>
            

            

            <code class="ruby">  def build_world_params</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="2" data-linenumber="101">
            
              <span class="hits">2</span>
            

            

            <code class="ruby">    new_params = world_params</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="2" data-linenumber="102">
            
              <span class="hits">2</span>
            

            

            <code class="ruby">    new_params[:user_id_id] = @cur_user.id</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="2" data-linenumber="103">
            
              <span class="hits">2</span>
            

            

            <code class="ruby">    new_params[:current_players] = 0 # Ensure current_players is set to 0</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="2" data-linenumber="104">
            
              <span class="hits">2</span>
            

            

            <code class="ruby">    new_params</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="105">
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="106">
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="107">
            
              <span class="hits">1</span>
            

            

            <code class="ruby">  def invalid_world_params?(params)</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="2" data-linenumber="108">
            
              <span class="hits">2</span>
            

            

            <code class="ruby">    max_players_limit = @cur_user.plus_user? ? 20 : 5</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="2" data-linenumber="109">
            
              <span class="hits">2</span>
            

            

            <code class="ruby">    params[:is_public] == &#39;0&#39; &amp;&amp; params[:max_player].to_i &gt; max_players_limit ||</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="110">
            

            

            <code class="ruby">      params[:world_code].blank? || params[:world_name].blank? || params[:max_player].blank?</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="111">
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="112">
            

            

            <code class="ruby">end</code>
          </li>
        </div>
      
    </ol>
  </pre>
</div>

      
        <div class="source_table" id="2667f2133f338aa49d38eb8e461ca77e3b64762d">
  <div class="header">
    <h3>app/models/friendship.rb</h3>
    <h4>
      <span class="yellow">
  86.67%
</span>

      lines covered
    </h4>

    

    <div class="t-line-summary">
      <b>15</b> relevant lines.
      <span class="green"><b>13</b> lines covered</span> and
      <span class="red"><b>2</b> lines missed.</span>
    </div>

    

  </div>

  <pre>
    <ol>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1">
            

            

            <code class="ruby"># frozen_string_literal: true</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="2">
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="3">
            

            

            <code class="ruby"># This defines a self-referential relationship between two users</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="4">
            
              <span class="hits">1</span>
            

            

            <code class="ruby">class Friendship &lt; ApplicationRecord</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="5">
            
              <span class="hits">1</span>
            

            

            <code class="ruby">  belongs_to :user</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="6">
            
              <span class="hits">1</span>
            

            

            <code class="ruby">  belongs_to :friend, class_name: &#39;User&#39;</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="7">
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="8">
            
              <span class="hits">1</span>
            

            

            <code class="ruby">  validates :friend_id, presence: true</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="9">
            
              <span class="hits">1</span>
            

            

            <code class="ruby">  validates :user_id, presence: true</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="10">
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="11">
            
              <span class="hits">1</span>
            

            

            <code class="ruby">  enum status: { pending: &#39;pending&#39;, accepted: &#39;accepted&#39; }</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="12">
            
              <span class="hits">1</span>
            

            

            <code class="ruby">  validates :status, presence: true</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="13">
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="14">
            
              <span class="hits">1</span>
            

            

            <code class="ruby">  validate :not_self</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="15">
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="16">
            

            

            <code class="ruby">  # given an user instance, fetch all userids of the users friends.</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="17">
            
              <span class="hits">1</span>
            

            

            <code class="ruby">  def self.friend_ids(usr)</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="18">
            

            

            <code class="ruby">    # if max is friends with admin</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="19">
            

            

            <code class="ruby">    # There should be a friendship with (maxID, adminID) OR (adminID, maxID)</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="20">
            

            

            <code class="ruby">    # But not both. So it’s a query to get both cases</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="21">
            

            

            <code class="ruby">    Friendship.where(friend_id: usr.id, status: &#39;accepted&#39;)</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="22">
            

            

            <code class="ruby">              .pluck(:user_id)</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="23">
            

            

            <code class="ruby">              .concat(Friendship.where(user_id: usr.id, status: &#39;accepted&#39;)</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="24">
            

            

            <code class="ruby">                                           .pluck(:friend_id))</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="25">
            

            

            <code class="ruby">              .uniq</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="26">
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="27">
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="28">
            

            

            <code class="ruby">  # given an user instance, fetch all friend requests from the DB</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="29">
            
              <span class="hits">1</span>
            

            

            <code class="ruby">  def self.requested_friend_ids(usr)</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="30">
            

            

            <code class="ruby">    Friendship.where(friend_id: usr.id, status: &#39;pending&#39;)</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="31">
            

            

            <code class="ruby">              .pluck(:user_id)</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="32">
            

            

            <code class="ruby">              .uniq</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="33">
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="34">
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="35">
            
              <span class="hits">1</span>
            

            

            <code class="ruby">  private</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="36">
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="37">
            
              <span class="hits">1</span>
            

            

            <code class="ruby">  def not_self</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="38">
            
              <span class="hits">1</span>
            

            

            <code class="ruby">    errors.add(:friend_id, &#39;Unfortunately, you cannot add yourself as a friend.&#39;) if user_id == friend_id</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="39">
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="40">
            

            

            <code class="ruby">end</code>
          </li>
        </div>
      
    </ol>
  </pre>
</div>

      
        <div class="source_table" id="841cffe5ec2171dffd913f8f79082bf72d86bcac">
  <div class="header">
    <h3>app/models/gridsquare.rb</h3>
    <h4>
      <span class="red">
  0.0%
</span>

      lines covered
    </h4>

    

    <div class="t-line-summary">
      <b>6</b> relevant lines.
      <span class="green"><b>0</b> lines covered</span> and
      <span class="red"><b>6</b> lines missed.</span>
    </div>

    

  </div>

  <pre>
    <ol>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1">
            

            

            <code class="ruby"># frozen_string_literal: true</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="2">
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="3">
            

            

            <code class="ruby"># Model dealing with one grid</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="4">
            

            

            <code class="ruby">class Gridsquare &lt; ApplicationRecord</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="5">
            

            

            <code class="ruby">  belongs_to :world</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="6">
            

            

            <code class="ruby">  validates :row, presence: true</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="7">
            

            

            <code class="ruby">  validates :col, presence: true</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="8">
            

            

            <code class="ruby">  has_one_attached :image</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="9">
            

            

            <code class="ruby">end</code>
          </li>
        </div>
      
    </ol>
  </pre>
</div>

      
        <div class="source_table" id="f6b58ed9e9645b33485a566bee0b69f1e3e60c5a">
  <div class="header">
    <h3>app/models/user.rb</h3>
    <h4>
      <span class="yellow">
  84.0%
</span>

      lines covered
    </h4>

    

    <div class="t-line-summary">
      <b>50</b> relevant lines.
      <span class="green"><b>42</b> lines covered</span> and
      <span class="red"><b>8</b> lines missed.</span>
    </div>

    

  </div>

  <pre>
    <ol>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1">
            

            

            <code class="ruby"># frozen_string_literal: true</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="2">
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="3">
            
              <span class="hits">1</span>
            

            

            <code class="ruby">require &#39;bcrypt&#39;</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="4">
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="5">
            

            

            <code class="ruby"># Model dealing with user accounts</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="6">
            
              <span class="hits">1</span>
            

            

            <code class="ruby">class User &lt; ApplicationRecord</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="7">
            
              <span class="hits">1</span>
            

            

            <code class="ruby">  has_many :friendships, dependent: :destroy, inverse_of: :user</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="8">
            
              <span class="hits">1</span>
            

            

            <code class="ruby">  has_many :friends, through: :friendships</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="9">
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="10">
            
              <span class="hits">1</span>
            

            

            <code class="ruby">  has_many :inverse_friendships, class_name: &#39;Friendship&#39;, foreign_key: &#39;friend_id&#39;, dependent: :destroy,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="11">
            

            

            <code class="ruby">                                 inverse_of: :user</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="12">
            
              <span class="hits">1</span>
            

            

            <code class="ruby">  has_many :inverse_friends, through: :inverse_friendships, source: :user</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="13">
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="14">
            
              <span class="hits">1</span>
            

            

            <code class="ruby">  has_many :user_worlds, dependent: :destroy</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="15">
            
              <span class="hits">1</span>
            

            

            <code class="ruby">  has_many :worlds, through: :user_worlds</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="16">
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="17">
            
              <span class="hits">1</span>
            

            

            <code class="ruby">  validates :email, presence: { message: &#39;is required.&#39; }, &#39;valid_email_2/email&#39;: true</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="18">
            
              <span class="hits">1</span>
            

            

            <code class="ruby">  validates :display_name, presence: { message: &#39;is required.&#39; }, uniqueness: { message: &#39;%&lt;value&gt;s is taken&#39; }</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="19">
            
              <span class="hits">1</span>
            

            

            <code class="ruby">  has_secure_password</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="20">
            
              <span class="hits">1</span>
            

            

            <code class="ruby">  validate :password_complexity</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="21">
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="22">
            
              <span class="hits">1</span>
            

            

            <code class="ruby">  def update_session_token</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="23">
            
              <span class="hits">1</span>
            

            

            <code class="ruby">    self.session_token = SecureRandom.hex(32)</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="24">
            
              <span class="hits">1</span>
            

            

            <code class="ruby">    save</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="25">
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="26">
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="27">
            
              <span class="hits">1</span>
            

            

            <code class="ruby">  def plus_user?</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="28">
            

            

            <code class="ruby">    plus_user</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="29">
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="30">
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="31">
            
              <span class="hits">1</span>
            

            

            <code class="ruby">  def purchase_plus_user</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="2" data-linenumber="32">
            
              <span class="hits">2</span>
            

            

            <code class="ruby">    cost_in_shards = 100 # Define the cost in shards for plus_user access</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="2" data-linenumber="33">
            
              <span class="hits">2</span>
            

            

            <code class="ruby">    if available_credits &gt;= cost_in_shards</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="2" data-linenumber="34">
            
              <span class="hits">2</span>
            

            

            <code class="ruby">      self.available_credits -= cost_in_shards</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="2" data-linenumber="35">
            
              <span class="hits">2</span>
            

            

            <code class="ruby">      self.plus_user = true</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="2" data-linenumber="36">
            
              <span class="hits">2</span>
            

            

            <code class="ruby">      save</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="2" data-linenumber="37">
            
              <span class="hits">2</span>
            

            

            <code class="ruby">      true</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="38">
            

            

            <code class="ruby">    else</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="39">
            

            

            <code class="ruby">      false</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="40">
            

            

            <code class="ruby">    end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="41">
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="42">
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="43">
            
              <span class="hits">1</span>
            

            

            <code class="ruby">  def generate_reset_password_token</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="44">
            

            

            <code class="ruby">    self.reset_password_token = SecureRandom.hex(32)</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="45">
            

            

            <code class="ruby">    self.reset_password_sent_at = Time.now.utc</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="46">
            

            

            <code class="ruby">    save</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="47">
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="48">
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="49">
            
              <span class="hits">1</span>
            

            

            <code class="ruby">  def invalid_reset_password_token?</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="50">
            

            

            <code class="ruby">    reset_password_sent_at &lt; 1.hour.ago # before an hour ~ more than an hour ago</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="51">
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="52">
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="53">
            
              <span class="hits">1</span>
            

            

            <code class="ruby">  def update_password(new_password)</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="54">
            

            

            <code class="ruby">    self.password = new_password</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="55">
            

            

            <code class="ruby">    save</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="56">
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="57">
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="58">
            
              <span class="hits">1</span>
            

            

            <code class="ruby">  private</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="59">
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="60">
            

            

            <code class="ruby">  # rubocop:disable all </code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="61">
            

            

            <code class="ruby">  # rubo cop complains that it&#39;s too long. and too many conditionals. The alternative is to have all</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="62">
            

            

            <code class="ruby">  # these as oneliner functions which is also bad....</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="63">
            
              <span class="hits">1</span>
            

            

            <code class="ruby">  def password_complexity #thanks chatGPT :) </code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="7" data-linenumber="64">
            
              <span class="hits">7</span>
            

            

            <code class="ruby">    return if password.blank?</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="65">
            

            

            <code class="ruby">    password_rules = {</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="10" data-linenumber="66">
            
              <span class="hits">10</span>
            

            

            <code class="ruby">      length: { condition: -&gt;(pwd) { pwd.length &gt;= 12 }, message: &#39;must be longer than 12 characters&#39; },</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="4" data-linenumber="67">
            
              <span class="hits">4</span>
            

            

            <code class="ruby">      digit: { condition: -&gt;(pwd) { pwd.match?(/\d/) }, message: &#39;must include a digit&#39; },</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="3" data-linenumber="68">
            
              <span class="hits">3</span>
            

            

            <code class="ruby">      uppercase: { condition: -&gt;(pwd) { pwd.match?(/[A-Z]/) }, message: &#39;must include one uppercase letter&#39; },</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="69">
            
              <span class="hits">1</span>
            

            

            <code class="ruby">      lowercase: { condition: -&gt;(pwd) { pwd.match?(/[a-z]/) }, message: &#39;must include one lowercase letter&#39; },</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="70">
            
              <span class="hits">1</span>
            

            

            <code class="ruby">      special_char: { condition: -&gt;(pwd) { pwd.match?(/[\W_]/) }, message: &#39;must include one special character&#39; }</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="71">
            

            

            <code class="ruby">    }</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="5" data-linenumber="72">
            
              <span class="hits">5</span>
            

            

            <code class="ruby">    password_rules.each do |key, rule|</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="14" data-linenumber="73">
            
              <span class="hits">14</span>
            

            

            <code class="ruby">      unless rule[:condition].call(password)</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="5" data-linenumber="74">
            
              <span class="hits">5</span>
            

            

            <code class="ruby">        errors.add(:password, rule[:message])</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="5" data-linenumber="75">
            
              <span class="hits">5</span>
            

            

            <code class="ruby">        break</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="76">
            

            

            <code class="ruby">      end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="77">
            

            

            <code class="ruby">    end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="78">
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="79">
            

            

            <code class="ruby">  # https://api.rubyonrails.org/v7.1/classes/ActiveModel/SecurePassword/ClassMethods.html</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="80">
            

            

            <code class="ruby">  # use authenticate for checking the password</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="81">
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="82">
            
              <span class="hits">1</span>
            

            

            <code class="ruby">  def self.find_user_by_display_name(display_name)</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="83">
            
              <span class="hits">1</span>
            

            

            <code class="ruby">    User.where([&#39;display_name = ?&#39;, display_name]).first</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="84">
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="85">
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="86">
            
              <span class="hits">1</span>
            

            

            <code class="ruby">  def self.find_user_by_session_token(session_token)</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="6" data-linenumber="87">
            
              <span class="hits">6</span>
            

            

            <code class="ruby">    User.where([&#39;session_token = ?&#39;, session_token]).first</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="88">
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="89">
            

            

            <code class="ruby">end</code>
          </li>
        </div>
      
    </ol>
  </pre>
</div>

      
        <div class="source_table" id="a1f6b1f417257d7d7e4221a3f0fcb8e2e202fc30">
  <div class="header">
    <h3>app/models/user_world.rb</h3>
    <h4>
      <span class="yellow">
  83.33%
</span>

      lines covered
    </h4>

    

    <div class="t-line-summary">
      <b>6</b> relevant lines.
      <span class="green"><b>5</b> lines covered</span> and
      <span class="red"><b>1</b> lines missed.</span>
    </div>

    

  </div>

  <pre>
    <ol>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1">
            

            

            <code class="ruby"># frozen_string_literal: true</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="2">
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="3">
            

            

            <code class="ruby"># UserWorld class is a model class that represents the relationship between a user and a world.</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="4">
            
              <span class="hits">1</span>
            

            

            <code class="ruby">class UserWorld &lt; ApplicationRecord</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="5">
            
              <span class="hits">1</span>
            

            

            <code class="ruby">  belongs_to :user</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="6">
            
              <span class="hits">1</span>
            

            

            <code class="ruby">  belongs_to :world</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="7">
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="8">
            
              <span class="hits">1</span>
            

            

            <code class="ruby">  validates :xp, numericality: { greater_than_or_equal_to: 0 }</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="9">
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="10">
            
              <span class="hits">1</span>
            

            

            <code class="ruby">  def self.find_by_ids(user_id, world_id)</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="11">
            

            

            <code class="ruby">    UserWorld.where(user_id: user_id, world_id: world_id).first</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="12">
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="13">
            

            

            <code class="ruby">end</code>
          </li>
        </div>
      
    </ol>
  </pre>
</div>

      
        <div class="source_table" id="783ef1938c362b87740078c5fd9de7ccf1e498ed">
  <div class="header">
    <h3>app/models/world.rb</h3>
    <h4>
      <span class="green">
  100.0%
</span>

      lines covered
    </h4>

    

    <div class="t-line-summary">
      <b>26</b> relevant lines.
      <span class="green"><b>26</b> lines covered</span> and
      <span class="red"><b>0</b> lines missed.</span>
    </div>

    

  </div>

  <pre>
    <ol>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1">
            

            

            <code class="ruby"># frozen_string_literal: true</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="2">
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="3">
            
              <span class="hits">1</span>
            

            

            <code class="ruby">require &#39;concurrent&#39;</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="4">
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="5">
            

            

            <code class="ruby"># The world that a user can join, including functions to initialize and</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="6">
            

            

            <code class="ruby"># update/retrieve information from a displayed grid.</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="7">
            
              <span class="hits">1</span>
            

            

            <code class="ruby">require &#39;net/http&#39;</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="8">
            
              <span class="hits">1</span>
            

            

            <code class="ruby">require &#39;json&#39;</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="9">
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="10">
            

            

            <code class="ruby"># represents the model class for the worlds object</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="11">
            
              <span class="hits">1</span>
            

            

            <code class="ruby">class World &lt; ApplicationRecord</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="12">
            
              <span class="hits">1</span>
            

            

            <code class="ruby">  has_many :gridsquares, dependent: :destroy</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="13">
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="14">
            
              <span class="hits">1</span>
            

            

            <code class="ruby">  has_many :user_worlds, dependent: :destroy</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="15">
            
              <span class="hits">1</span>
            

            

            <code class="ruby">  has_many :users, through: :user_worlds</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="16">
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="17">
            
              <span class="hits">1</span>
            

            

            <code class="ruby">  validates :current_players, numericality: { greater_than_or_equal_to: 0 }</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="18">
            
              <span class="hits">1</span>
            

            

            <code class="ruby">  before_create :init_current_players</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="19">
            
              <span class="hits">1</span>
            

            

            <code class="ruby">  @@dim = 6 # rubocop:disable Style/ClassVars</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="20">
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="21">
            

            

            <code class="ruby">  # this must be done this way, active stroage DOES NOT WORK</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="22">
            

            

            <code class="ruby">  # with after_create call back when seeding!!!!!!!</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="23">
            
              <span class="hits">1</span>
            

            

            <code class="ruby">  def init_if_not_inited</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="3" data-linenumber="24">
            
              <span class="hits">3</span>
            

            

            <code class="ruby">    return unless gridsquares.empty?</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="25">
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="2" data-linenumber="26">
            
              <span class="hits">2</span>
            

            

            <code class="ruby">    initialize_grid</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="27">
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="28">
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="29">
            
              <span class="hits">1</span>
            

            

            <code class="ruby">  def self.dim</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="30">
            
              <span class="hits">1</span>
            

            

            <code class="ruby">    @@dim</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="31">
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="32">
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="33">
            
              <span class="hits">1</span>
            

            

            <code class="ruby">  private</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="34">
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="35">
            
              <span class="hits">1</span>
            

            

            <code class="ruby">  def initialize_grid</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="36">
            
              <span class="hits">1</span>
            

            

            <code class="ruby">    (1..@@dim).each do |row|</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="6" data-linenumber="37">
            
              <span class="hits">6</span>
            

            

            <code class="ruby">      (1..@@dim).each do |col|</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="36" data-linenumber="38">
            
              <span class="hits">36</span>
            

            

            <code class="ruby">        gridsquares.create!(row: row, col: col)</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="39">
            

            

            <code class="ruby">      end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="40">
            

            

            <code class="ruby">    end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="41">
            

            

            <code class="ruby">    # only these squares or we get rate limited.</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="42">
            
              <span class="hits">1</span>
            

            

            <code class="ruby">    Concurrent::Future.execute { OpenaiWrapperHelper.create_square(1, 1, self) }</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="43">
            
              <span class="hits">1</span>
            

            

            <code class="ruby">    Concurrent::Future.execute { OpenaiWrapperHelper.create_square(2, 1, self) }</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="44">
            
              <span class="hits">1</span>
            

            

            <code class="ruby">    Concurrent::Future.execute { OpenaiWrapperHelper.create_square(2, 2, self) }</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="45">
            
              <span class="hits">1</span>
            

            

            <code class="ruby">    Concurrent::Future.execute { OpenaiWrapperHelper.create_square(1, 2, self) }</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="46">
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="47">
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="48">
            
              <span class="hits">1</span>
            

            

            <code class="ruby">  def init_current_players</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="49">
            
              <span class="hits">1</span>
            

            

            <code class="ruby">    self.current_players ||= 0</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="50">
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="51">
            

            

            <code class="ruby">end</code>
          </li>
        </div>
      
    </ol>
  </pre>
</div>

      
      </div>
    </div>
  </body>
</html>
